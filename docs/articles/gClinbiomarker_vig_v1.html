<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>gClinBiomarker Vignette • gClinBiomarker</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">gClinBiomarker</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/gClinbiomarker_example_use_case.html">gClinBiomarker: example use cases</a>
    </li>
    <li>
      <a href="../articles/gClinbiomarker_vig_v1.html">gClinBiomarker Vignette</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>gClinBiomarker Vignette</h1>
                        <h4 class="author">Ning Leng, Alexey Pronin, Christina Rabe, Doug Kelkhoff, Kwame Okrah</h4>
            
            <h4 class="date">2017-11-11</h4>
          </div>

    
    
<div class="contents">
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h1>
<p><em>gClinBiomarker</em> is an R package that allows users to easily perform biomarker analyses and generate high-quality figures and tables. It contains a set of functions covering essential biomarker analyses conducted in both oncology and non-oncology trials. It also provides an R markdown template that allows users to plug in their data set and generate a biomarker analysis report with “one-click”. The report contains demographics checking, biomarker property characterization, cutoff exploration (for continuous biomarkers), subgroup analysis, and longitudinal analysis. The package takes either VADs (AdAM) or a customized csv/data frame.</p>
<p>gClinBiomarker is built on top of the existing Baseline R package (biomarkers). The bulk of the work done on this package is on the back-end:</p>
<ul>
<li>streamline the original code,</li>
<li>create robust documentation, and</li>
<li>modularize the package for future extensions.</li>
</ul>
<p>This vignette provides general guidelines of using gClinBiomarker package. Example workflows are also provided in the vignette, which cover essential biomarker analyses.</p>
<p>For advanced usage, more detailed examples can be found at:</p>
<p><a href="https://github.roche.com/lengn/gClinbiomarker_documents/blob/master/gClinbiomarker_example_use_case.pdf" class="uri">https://github.roche.com/lengn/gClinbiomarker_documents/blob/master/gClinbiomarker_example_use_case.pdf</a></p>
<p>The Rmarkdown templates can be found at:</p>
<p><a href="https://github.roche.com/lengn/gClinbiomarker_documents/tree/master/Markdown_templates" class="uri">https://github.roche.com/lengn/gClinbiomarker_documents/tree/master/Markdown_templates</a></p>
</div>
<div id="install-and-load-the-package" class="section level1">
<h1 class="hasAnchor">
<a href="#install-and-load-the-package" class="anchor"></a>Install and load the package</h1>
<p>To install this package from R, use install_github() function from the devtools package</p>
<p>In R, type:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(devtools)
<span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">"RPackages/gClinBiomarker"</span>, <span class="dt">host=</span><span class="st">"https://github.roche.com/api/v3"</span>)</code></pre></div>
<p>Before analysis can proceed, the gClinBiomarker package must be loaded into the working space:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gClinBiomarker)</code></pre></div>
</div>
<div id="input" class="section level1">
<h1 class="hasAnchor">
<a href="#input" class="anchor"></a>Input</h1>
<div id="input-requirement" class="section level2">
<h2 class="hasAnchor">
<a href="#input-requirement" class="anchor"></a>Input requirement</h2>
<p>Functions in gClinBiomarkers package take data frame as the input format. In this data frame, clinical data and biomarker data should all be included as columns. Rows are samples.</p>
<p>If only baseline biomarker analysis will be performed, the data frame should have one patient per row, without duplicated entries for any patient.</p>
<p>If longitudinal analysis will be performed, one patient may have multiple enteries for multiple visits.</p>
<p>Functions  and  may also be used to read in data in csv format and sas7bdat format.</p>
</div>
<div id="example-data-set-baseline-only" class="section level2">
<h2 class="hasAnchor">
<a href="#example-data-set-baseline-only" class="anchor"></a>Example data set: baseline only</h2>
<p>An example data set is included in the package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(input)</code></pre></div>
<pre><code>##   Patient.ID Sample.ID Arm Age Weight ECOG Sex Baseline.SLD        Country
## 1     PID001    SID001 TRT  40   61.0    0   F     550.4970 Western Europe
## 2     PID002    SID002 TRT  60   87.0    1   F     549.7751            USA
## 3     PID003    SID003 TRT  53   57.6    1   M     548.8829 Western Europe
## 4     PID004    SID004 TRT  44   57.0    0   F     549.6050            USA
## 5     PID005    SID005 TRT  49   72.5    2   F     551.5498          Other
## 6     PID006    SID006 TRT  62   76.0    0   M     549.2565          Other
##   CD8.ihc KRAS.mutant KRAS.exprs       OS      PFS  Response BEP OS.event
## 1       3      Mutant     171.25 9.691992 5.782341        PR   1        0
## 2       2   Wild Type       2.77 4.435318 1.412731        PD   1        1
## 3       3   Wild Type      61.82 9.691992 1.215606        PD   1        0
## 4       1      Mutant      71.51 1.905544 1.905544        PD   1        0
## 5      NA        &lt;NA&gt;         NA 2.628337 2.628337        SD   0        1
## 6       2      Mutant      44.63 4.829569 4.139630 NON CR/PD   1        0
##   PFS.event Lab_ontrt
## 1         0 28.993922
## 2         1  9.890427
## 3         1 26.896020
## 4         1  5.421392
## 5         1 14.741382
## 6         0 16.957035</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(input)</code></pre></div>
<pre><code>## 'data.frame':    550 obs. of  19 variables:
##  $ Patient.ID  : chr  "PID001" "PID002" "PID003" "PID004" ...
##  $ Sample.ID   : chr  "SID001" "SID002" "SID003" "SID004" ...
##  $ Arm         : Factor w/ 2 levels "CTRL","TRT": 2 2 2 2 2 2 2 2 2 1 ...
##  $ Age         : int  40 60 53 44 49 62 70 49 62 45 ...
##  $ Weight      : num  61 87 57.6 57 72.5 76 46 69.3 65 54 ...
##  $ ECOG        : int  0 1 1 0 2 0 0 1 0 1 ...
##  $ Sex         : chr  "F" "F" "M" "F" ...
##  $ Baseline.SLD: num  550 550 549 550 552 ...
##  $ Country     : Factor w/ 3 levels "Other","USA",..: 3 2 3 2 1 1 3 3 3 1 ...
##  $ CD8.ihc     : num  3 2 3 1 NA 2 NA 1 NA NA ...
##  $ KRAS.mutant : Factor w/ 2 levels "Mutant","Wild Type": 1 2 2 1 NA 1 NA 2 NA NA ...
##  $ KRAS.exprs  : num  171.25 2.77 61.82 71.51 NA ...
##  $ OS          : num  9.69 4.44 9.69 1.91 2.63 ...
##  $ PFS         : num  5.78 1.41 1.22 1.91 2.63 ...
##  $ Response    : Factor w/ 6 levels "CR","NE","NON CR/PD",..: 5 4 4 4 6 3 4 3 4 6 ...
##  $ BEP         : num  1 1 1 1 0 1 0 1 0 0 ...
##  $ OS.event    : int  0 1 0 0 1 0 0 0 1 0 ...
##  $ PFS.event   : int  0 1 1 1 1 0 1 0 1 0 ...
##  $ Lab_ontrt   : num  28.99 9.89 26.9 5.42 14.74 ...</code></pre>
<p>The columns indicates:</p>
<ul>
<li>Patient.ID: patient ID</li>
<li>Sample.ID: sample ID</li>
<li>Arm: treatment arm</li>
<li>Age: age (baseline clinical variable, continuous)</li>
<li>Age: baseline body Age (baseline clinical variable, continuous)</li>
<li>ECOG: ECOG (baseline clinical variable, ordinal)</li>
<li>Sex: gender (baseline clinical variable, binary)</li>
<li>Baseline.SLD: baseline SLD (baseline clinical variable, continuous)</li>
<li>Country: region (baseline clinical variable, categorical)</li>
<li>CD8.ihc: CD8 IHC measurement (biomarker, protein level, ordinal)</li>
<li>KRAS.mutant: KRAS mutation status (biomarker, DNA level, binary)</li>
<li>KRAS.exprs: KRAS gene expression (biomarker, mRNA level, continuous)</li>
<li>OS: overall survival (clinical outcome)</li>
<li>OS.event: censoring indicator for OS, 1 indicates event and 0 indicates censoring (clinical outcome)</li>
<li>PFS: progression free survival (clinical outcome)</li>
<li>PFS.event: censoring indicator for PFS, 1 indicates event and 0 indicates censoring (clinical outcome)</li>
<li>Lab_ontrt: example continuous surrogate endpoint - on treatment lab data; one record per patient</li>
<li>Response: best overall overall response (clinical outcome, ordinal)</li>
<li>BEP: Biomarker evaluable population indicator. 1: in biomarker evaluable population, 2: not in. (When evaluable multiple biomarkers, we may want to take the same set of patients for all evaluations. Then the can be defined as the patients who have valid measurement for all biomarkers. In this example data set, the BEP is defined as patients who have CD8 IHC data, KRAS mutation data, and KRAS expression data. If only one biomarker is of interest, BEP could be defined as patients who have valid measure for this biomarker. A BEP column is required to perform certain analyses (e.g. selection bias examination of BEP).)</li>
</ul>
</div>
</div>
<div id="biomarker-workflow" class="section level1">
<h1 class="hasAnchor">
<a href="#biomarker-workflow" class="anchor"></a>Biomarker workflow</h1>
<div id="continuous-biomarker-in-a-two-arm-study-with-survival-outcome" class="section level2">
<h2 class="hasAnchor">
<a href="#continuous-biomarker-in-a-two-arm-study-with-survival-outcome" class="anchor"></a>Continuous biomarker in a two-arm study with survival outcome</h2>
<p>We use PFS as our primary endpoint, KRAS.exprs as the biomarker of interest.</p>
<div id="representativeness-selection-bias-of-biomarker-population" class="section level3">
<h3 class="hasAnchor">
<a href="#representativeness-selection-bias-of-biomarker-population" class="anchor"></a>Representativeness: Selection Bias of Biomarker Population</h3>
<p>In this section, we are trying to answer the question: <em>Are biomarker evaluable population representative of the full population population? </em></p>
<p>Key baseline demographics and prognostic characteristics (including stratification variables and any variables with known prognostic effect) and efficacy outcomes should be summarized by treatment groups and compared between biomarker evaluable population (BEP) and the full population. These analyses are conducted to investigate any potential selection bias associated with the availability of the biomarker (e.g. we may not get enough tissue for patients whose tumor size is small. Therefore they may be exlcuded from BEP).</p>
<div id="check-selection-bias-in-terms-of-key-clinical-variables-between-full-population-and-bep" class="section level4">
<h4 class="hasAnchor">
<a href="#check-selection-bias-in-terms-of-key-clinical-variables-between-full-population-and-bep" class="anchor"></a>Check selection bias in terms of key clinical variables, between full population and BEP</h4>
<p>Function  can be used to perform selection bias checking of clinical variables. For example, if Age and Sex are two key clinical variables, we can perform the selection bias checking by:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="kw"><a href="../reference/SummaryVars.html">SummaryVars</a></span>(<span class="dt">data=</span>input, <span class="dt">trt=</span><span class="st">'Arm'</span>, <span class="dt">subgroup=</span><span class="st">'BEP'</span>, <span class="dt">var=</span><span class="kw">c</span>(<span class="st">'Sex'</span>,<span class="st">'Age'</span>), 
       <span class="dt">var.class=</span><span class="kw">c</span>(<span class="st">'categorical'</span>,<span class="st">'numeric'</span>))</code></pre></div>
<pre><code>##         All(CTRL)    BEP(CTRL)     All(TRT)    BEP(TRT)     
## Sex     ""           ""            ""          ""           
## Total   "182"        "81"          "368"       "176"        
## NA's    "0"          "0"           "0"         "0"          
## F       "89 (48.9%)" "39 (48.15%)" "184 (50%)" "90 (51.14%)"
## M       "93 (51.1%)" "42 (51.85%)" "184 (50%)" "86 (48.86%)"
## Age     ""           ""            ""          ""           
## N       "182"        "81"          "368"       "176"        
## Mean    "52.54"      "53.1"        "54.03"     "54.42"      
## Median  "51.5"       "52"          "54"        "54"         
## Min-Max "27...85"    "32...85"     "30...89"   "33...89"    
## NA's    "0"          "0"           "0"         "0"</code></pre>
<p> function from knitr package may be used in Rmarkdown file for better table display:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(
  <span class="kw"><a href="../reference/SummaryVars.html">SummaryVars</a></span>(<span class="dt">data=</span>input, <span class="dt">trt=</span><span class="st">'Arm'</span>, <span class="dt">subgroup=</span><span class="st">'BEP'</span>, <span class="dt">var=</span><span class="kw">c</span>(<span class="st">'Sex'</span>,<span class="st">'Age'</span>), 
       <span class="dt">var.class=</span><span class="kw">c</span>(<span class="st">'categorical'</span>,<span class="st">'numeric'</span>))
)</code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="left">All(CTRL)</th>
<th align="left">BEP(CTRL)</th>
<th align="left">All(TRT)</th>
<th align="left">BEP(TRT)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Sex</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td>Total</td>
<td align="left">182</td>
<td align="left">81</td>
<td align="left">368</td>
<td align="left">176</td>
</tr>
<tr class="odd">
<td>NA’s</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td>F</td>
<td align="left">89 (48.9%)</td>
<td align="left">39 (48.15%)</td>
<td align="left">184 (50%)</td>
<td align="left">90 (51.14%)</td>
</tr>
<tr class="odd">
<td>M</td>
<td align="left">93 (51.1%)</td>
<td align="left">42 (51.85%)</td>
<td align="left">184 (50%)</td>
<td align="left">86 (48.86%)</td>
</tr>
<tr class="even">
<td>Age</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td>N</td>
<td align="left">182</td>
<td align="left">81</td>
<td align="left">368</td>
<td align="left">176</td>
</tr>
<tr class="even">
<td>Mean</td>
<td align="left">52.54</td>
<td align="left">53.1</td>
<td align="left">54.03</td>
<td align="left">54.42</td>
</tr>
<tr class="odd">
<td>Median</td>
<td align="left">51.5</td>
<td align="left">52</td>
<td align="left">54</td>
<td align="left">54</td>
</tr>
<tr class="even">
<td>Min-Max</td>
<td align="left">27…85</td>
<td align="left">32…85</td>
<td align="left">30…89</td>
<td align="left">33…89</td>
</tr>
<tr class="odd">
<td>NA’s</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
</tbody>
</table>
<p>Here we specify the treatment column via parameter , and specify the BEP column via parameter . The comparision will be between BEP and the full population (BEP + nonBEP). If BEP vs. non BEP comparison is of interet, the user may specify parameter .</p>
<p>The clinical variables of interest can be specified via . Parameter  can be used to specify class of the variable. Possible classes are “categorical”,“numeric”,“ordered.factor”. If var.class is not specified, the program will define the variable class based on class of the column (class()). Note that for ordinal variable whose levels are numbers, the column need to be converted to ordered factor. Otherwise it will be treated as continuous variable.</p>
</div>
<div id="check-whether-the-clinical-outcome-in-bep-is-comparable-to-the-full-population" class="section level4">
<h4 class="hasAnchor">
<a href="#check-whether-the-clinical-outcome-in-bep-is-comparable-to-the-full-population" class="anchor"></a>Check whether the clinical outcome in BEP is comparable to the full population</h4>
<p>Function  can be used to compare survival outcome in BEP vs. the full population:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/CompareKM.html">CompareKM</a></span>(<span class="dt">data=</span>input,<span class="dt">tte=</span><span class="st">'PFS'</span>, <span class="dt">cen=</span><span class="st">'PFS.event'</span>,<span class="dt">trt=</span><span class="st">'Arm'</span>, <span class="dt">bep=</span><span class="st">'BEP'</span>)</code></pre></div>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-6-1.png" width="960"></p>
<p>By default, the KM curve and 95% CI will be plotted for each arm. The BEP KM curve is expected to be within the full population confidence bands.</p>
</div>
<div id="examine-whether-the-prognosticpredictivenull-trend-of-key-clinical-variables-holds-in-bep" class="section level4">
<h4 class="hasAnchor">
<a href="#examine-whether-the-prognosticpredictivenull-trend-of-key-clinical-variables-holds-in-bep" class="anchor"></a>Examine whether the prognostic/predictive/null trend of key clinical variables holds in BEP</h4>
<p>Function PlotTanForestMulti may be used to examine whether any of the key clinical variables show predictive trend in BEP:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/PlotTabForestMulti.html">PlotTabForestMulti</a></span>(<span class="dt">data=</span>input,
                                  <span class="dt">outcome.class=</span><span class="st">"survival"</span>,
                                  <span class="dt">outcome.var=</span><span class="kw">c</span>(<span class="st">"PFS"</span>,<span class="st">"PFS.event"</span>),
                                  <span class="dt">trt=</span><span class="st">"Arm"</span>,
                                  <span class="dt">var=</span><span class="kw">c</span>(<span class="st">"Sex"</span>,<span class="st">"Weight"</span>),
                   <span class="dt">bep=</span><span class="st">"BEP"</span>,<span class="dt">bep.indicator=</span><span class="dv">1</span>, <span class="dt">compare.bep.itt=</span><span class="ot">TRUE</span>
                   )</code></pre></div>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-7-1.png" width="960"></p>
<p>From the plot above, we can see that variable Sex doesn’t show a predictive trend in full population (similar trt/ctrl HR in male and female group). However, in BEP the variable Sex has numerically smaller trt/ctrl HR in Male group. Although from the SummaryVars() result, the percentages of Male are comparable between full population and BEP, it is still possible that the male patients have better clinical outcome than the female group. This is likely due to some selection bias that we weren’t be able to capture in previous steps (e.g. unmeasured variable). In downstream analyses, if the biomarker subgroup also show a predictive effect, we will need to check that whether it is confounded by Sex.</p>
</div>
<div id="compare-treatment-effect-estimation-in-full-population-and-in-bep-adjusted-for-key-clinical-variables" class="section level4">
<h4 class="hasAnchor">
<a href="#compare-treatment-effect-estimation-in-full-population-and-in-bep-adjusted-for-key-clinical-variables" class="anchor"></a>Compare treatment effect estimation in full population and in BEP, adjusted for key clinical variables</h4>
<p>Another important summary statistic to look at is the trt/ctrl (target/reference) HR in full population and trt/ctrl HR in BEP. Although highly overlapped curves in figures generated by CompareKM() function suggests that the unadjusted HR in full population and BEP will be comparable, it will be necessary to check adjusted HR as well. The following code chunk shows how to use the function CoxTab() to fit a multivariate Cox model by including treatment variable, Sex and Age.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">input.bep &lt;-<span class="st"> </span><span class="kw">subset</span>(input, BEP==<span class="dv">1</span>) <span class="co"># dataset with only BEP samples</span>

<span class="kw">kable</span>(
  <span class="kw"><a href="../reference/CoxTab.html">CoxTab</a></span>(<span class="dt">data=</span>input,<span class="dt">tte=</span><span class="st">"PFS"</span>, <span class="dt">cens=</span><span class="st">"PFS.event"</span>,  <span class="dt">var=</span><span class="st">'Arm'</span>, 
       <span class="dt">var.class=</span><span class="st">"categorical"</span>),
<span class="dt">caption=</span><span class="st">"full population, unadjusted"</span>
)</code></pre></div>
<table class="table">
<caption>full population, unadjusted</caption>
<thead><tr class="header">
<th></th>
<th align="left">HR</th>
<th align="left">CI.low</th>
<th align="left">CI.high</th>
<th align="left">p-value</th>
<th align="left">n.trt</th>
<th align="left">n.ref</th>
</tr></thead>
<tbody><tr class="odd">
<td>Arm (TRT/CTRL)</td>
<td align="left">0.54</td>
<td align="left">0.43</td>
<td align="left">0.67</td>
<td align="left">7.8e-08</td>
<td align="left">368</td>
<td align="left">182</td>
</tr></tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(
  <span class="kw"><a href="../reference/CoxTab.html">CoxTab</a></span>(<span class="dt">data=</span>input,<span class="dt">tte=</span><span class="st">"PFS"</span>, <span class="dt">cens=</span><span class="st">"PFS.event"</span>,  <span class="dt">var=</span><span class="kw">c</span>(<span class="st">'Arm'</span>,<span class="st">'Sex'</span>,<span class="st">"Weight"</span>), 
       <span class="dt">var.class=</span><span class="kw">c</span>(<span class="st">"categorical"</span>,<span class="st">"categorical"</span>,<span class="st">"numeric"</span>)),
<span class="dt">caption=</span><span class="st">"full population, adjusted for Sex, Weight"</span>
)</code></pre></div>
<table class="table">
<caption>full population, adjusted for Sex, Weight</caption>
<thead><tr class="header">
<th></th>
<th align="left">HR</th>
<th align="left">CI.low</th>
<th align="left">CI.high</th>
<th align="left">p-value</th>
<th align="left">n.trt</th>
<th align="left">n.ref</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Arm (TRT/CTRL)</td>
<td align="left">0.53</td>
<td align="left">0.42</td>
<td align="left">0.67</td>
<td align="left">5.6e-08</td>
<td align="left">368</td>
<td align="left">182</td>
</tr>
<tr class="even">
<td>Sex (M/F)</td>
<td align="left">0.9</td>
<td align="left">0.72</td>
<td align="left">1.12</td>
<td align="left">0.35</td>
<td align="left">277</td>
<td align="left">273</td>
</tr>
<tr class="odd">
<td>Weight</td>
<td align="left">1</td>
<td align="left">0.99</td>
<td align="left">1</td>
<td align="left">0.39</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(
  <span class="kw"><a href="../reference/CoxTab.html">CoxTab</a></span>(<span class="dt">data=</span>input.bep,<span class="dt">tte=</span><span class="st">"PFS"</span>, <span class="dt">cens=</span><span class="st">"PFS.event"</span>,  <span class="dt">var=</span><span class="st">'Arm'</span>, 
       <span class="dt">var.class=</span><span class="st">"categorical"</span>),
<span class="dt">caption=</span><span class="st">"BEP, unadjusted"</span>
)</code></pre></div>
<table class="table">
<caption>BEP, unadjusted</caption>
<thead><tr class="header">
<th></th>
<th align="left">HR</th>
<th align="left">CI.low</th>
<th align="left">CI.high</th>
<th align="left">p-value</th>
<th align="left">n.trt</th>
<th align="left">n.ref</th>
</tr></thead>
<tbody><tr class="odd">
<td>Arm (TRT/CTRL)</td>
<td align="left">0.49</td>
<td align="left">0.36</td>
<td align="left">0.69</td>
<td align="left">3.1e-05</td>
<td align="left">176</td>
<td align="left">81</td>
</tr></tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(
  <span class="kw"><a href="../reference/CoxTab.html">CoxTab</a></span>(<span class="dt">data=</span>input.bep,<span class="dt">tte=</span><span class="st">"PFS"</span>, <span class="dt">cens=</span><span class="st">"PFS.event"</span>,  <span class="dt">var=</span><span class="kw">c</span>(<span class="st">'Arm'</span>,<span class="st">'Sex'</span>,<span class="st">"Weight"</span>), 
       <span class="dt">var.class=</span><span class="kw">c</span>(<span class="st">"categorical"</span>,<span class="st">"categorical"</span>,<span class="st">"numeric"</span>)),
<span class="dt">caption=</span><span class="st">"BEP, adjusted for Sex, Weight"</span>
)</code></pre></div>
<table class="table">
<caption>BEP, adjusted for Sex, Weight</caption>
<thead><tr class="header">
<th></th>
<th align="left">HR</th>
<th align="left">CI.low</th>
<th align="left">CI.high</th>
<th align="left">p-value</th>
<th align="left">n.trt</th>
<th align="left">n.ref</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Arm (TRT/CTRL)</td>
<td align="left">0.48</td>
<td align="left">0.34</td>
<td align="left">0.67</td>
<td align="left">1.4e-05</td>
<td align="left">176</td>
<td align="left">81</td>
</tr>
<tr class="even">
<td>Sex (M/F)</td>
<td align="left">0.78</td>
<td align="left">0.56</td>
<td align="left">1.08</td>
<td align="left">0.13</td>
<td align="left">128</td>
<td align="left">129</td>
</tr>
<tr class="odd">
<td>Weight</td>
<td align="left">0.99</td>
<td align="left">0.98</td>
<td align="left">1</td>
<td align="left">0.12</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<p>If any selection bias is suspected, the user may consider to stratify for the imbalanced factor in downstream analysis (e.g. unstratified analysis as primary analysis and stratified analysis as sensitivity analysis).</p>
</div>
</div>
<div id="biomarker-property-and-its-association-to-clinical-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#biomarker-property-and-its-association-to-clinical-variables" class="anchor"></a>Biomarker property and its association to clinical variables</h3>
<p>Before performing cutoff exploraotry analysis, it is important to check a biomarker’s property. For example, whether this biomarker has a bi-modal or multi modal distribution - if so, this biomarker may has natural cutoff.<br>
Relationship between the biomarker and key demographic and prognostic variables should also be investigated using bivariate plots. Prognostic property of the biomarker should also be assessed, by estimates of the clinical efficacy in the control arm.</p>
<p>The  function could be used to generate single variate plot for biomaker and clinical covariates. It can also be used to generate bi-variate plots to investigate biomarker-clinical variable relationship.</p>
<div id="biomarker-property-and-relationship-to-clinical-variable" class="section level4">
<h4 class="hasAnchor">
<a href="#biomarker-property-and-relationship-to-clinical-variable" class="anchor"></a>Biomarker property and relationship to clinical variable</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/PlotProperty.html">PlotProperty</a></span>(<span class="dt">data=</span>input, <span class="dt">biomarker.var=</span><span class="st">"KRAS.exprs"</span>, <span class="dt">biomarker.class=</span><span class="st">"numeric"</span>,
             <span class="dt">var=</span><span class="kw">c</span>(<span class="st">"Sex"</span>, <span class="st">"Country"</span>), <span class="dt">var.class=</span><span class="kw">c</span>(<span class="st">"categorical"</span>, <span class="st">"categorical"</span>),
             <span class="dt">log2=</span><span class="ot">TRUE</span>, <span class="dt">par.param =</span> <span class="kw">list</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)))</code></pre></div>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-9-1.png" width="1152"></p>
</div>
<div id="whether-the-biomarker-show-within-arm-trend" class="section level4">
<h4 class="hasAnchor">
<a href="#whether-the-biomarker-show-within-arm-trend" class="anchor"></a>Whether the biomarker show within-arm trend</h4>
<p>Function  can be used to investigate whether the biomarker shows within-arm trend:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">input.ctrl &lt;-<span class="st"> </span><span class="kw">subset</span>(input, Arm==<span class="st">"CTRL"</span>) ## Data with only ctrl samples
res.multicut.ctrl &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PlotTabForestBiomarker.html">PlotTabForestBiomarker</a></span>(<span class="dt">data=</span>input.ctrl,
                                  <span class="dt">outcome.class=</span><span class="st">"survival"</span>,
                                  <span class="dt">outcome.var=</span><span class="kw">c</span>(<span class="st">"PFS"</span>,<span class="st">"PFS.event"</span>),
                                  <span class="dt">var=</span><span class="st">"KRAS.exprs"</span>, 
                                  <span class="dt">var.class=</span><span class="st">"numeric"</span>,
                                  <span class="dt">percentile.cutoff=</span><span class="kw">c</span>(.<span class="dv">25</span>,.<span class="dv">5</span>,.<span class="dv">75</span>), <span class="dt">main.prefix=</span><span class="st">"CTRL"</span>,
                                  <span class="dt">greater=</span><span class="ot">TRUE</span>, <span class="dt">less=</span><span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## Some NAs in var column, will define the non NA entries as BEP</code></pre>
<pre><code>## only 1 arm; show.itt is set to FALSE</code></pre>
<pre><code>## only 1 arm; show.bep is set to FALSE</code></pre>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-10-1.png" width="768"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">input.trt &lt;-<span class="st"> </span><span class="kw">subset</span>(input, Arm==<span class="st">"TRT"</span>) ## Data with only trt samples
res.multicut.trt &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PlotTabForestBiomarker.html">PlotTabForestBiomarker</a></span>(<span class="dt">data=</span>input.trt,
                                  <span class="dt">outcome.class=</span><span class="st">"survival"</span>,
                                  <span class="dt">outcome.var=</span><span class="kw">c</span>(<span class="st">"PFS"</span>,<span class="st">"PFS.event"</span>),
                                  <span class="dt">var=</span><span class="st">"KRAS.exprs"</span>, 
                                  <span class="dt">var.class=</span><span class="st">"numeric"</span>,
                                  <span class="dt">percentile.cutoff=</span><span class="kw">c</span>(.<span class="dv">25</span>,.<span class="dv">5</span>,.<span class="dv">75</span>), <span class="dt">main.prefix=</span><span class="st">"TRT"</span>, 
                                  <span class="dt">greater=</span><span class="ot">TRUE</span>, <span class="dt">less=</span><span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## Some NAs in var column, will define the non NA entries as BEP</code></pre>
<pre><code>## only 1 arm; show.itt is set to FALSE</code></pre>
<pre><code>## only 1 arm; show.bep is set to FALSE</code></pre>
<pre><code>## Warning in par(old.par): calling par(new=TRUE) with no plot</code></pre>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-10-2.png" width="768"></p>
<p>We first get dataset input.ctrl and input.trt, which only contains patients in ctrl arm and trt arm, respectively. In function , time to event variable and censoring variable need to be specified via . The biomarker variable can be specified via . By specifying  as  and specifying  TRUE+, the program calculates within-arm HR of biomarker &gt;= 25% vs &lt;25% group, biomarker &gt;= 50% vs &lt;50% group, and biomarker &gt;= 75% vs &lt;75% group.</p>
<p>In ctrl arm, patients who have expression &gt;= 75% have slightly better PFS - &gt;= 75% vs &lt;75% HR is 0.83, and the median PFS is slightly higher in &gt;= 75% group (4.73) vs &lt;75% (3.45).</p>
<p>In trt arm, within-arm trend is seen in all three comparisons - for all 3 cutoffs, patients with higher expression have longer PFS than patients with low expression. The biomarker high vs. low HR are all around 0.5.</p>
<p>If strong within-arm effect is seen in both arms, the biomarker may be prognostic but not predictive.</p>
<p>If stratified or adjusted analyses are of interest, they can be specified via parameters  and .</p>
</div>
</div>
<div id="seeking-for-predictive-trend-biomarker-cutoff-explorationselection" class="section level3">
<h3 class="hasAnchor">
<a href="#seeking-for-predictive-trend-biomarker-cutoff-explorationselection" class="anchor"></a>Seeking for predictive trend: Biomarker cutoff exploration/selection</h3>
<p>Example codes in this section can be used to examine multiple candidate cutoffs for a continuous biomarker. The need for cut-off determination should be rooted in the development strategy. In general, an exhaustive search looking at all possible cut-off values is not recommended for decision making. Over-optimized cutoff using one set of clinical data may lead to hard-to-reproduce results. When determining a cutoff, biomarker property should be considered - e.g. cut at a low-dense point may be more robust to population shift. The cutoff selection should also fit the program’s stratigitic considerations. There is always a prevalence-effect size trade-off, inputs from multiple functions are needed - for example whether the team is willing to take more risk in PTS (high prevalence, weaker signal) or the team is willing to target at smaller population (lower prevalence, stronger signal)</p>
<div id="try-different-cutoffs---look-for-consistent-trend" class="section level4">
<h4 class="hasAnchor">
<a href="#try-different-cutoffs---look-for-consistent-trend" class="anchor"></a>Try different cutoffs - look for consistent trend</h4>
<p>Function  can also be used to investigate whether the biomarker is predictive across arm. To perform cross-arm analysis, parameter  needs to be specified. By specifying  ane , trt/ctrl HR of biomarker &gt;= 25% group, biomarker &gt;= 50% group, and biomarker &gt;= 75% group are calculated:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res.multicut &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PlotTabForestBiomarker.html">PlotTabForestBiomarker</a></span>(<span class="dt">data=</span>input,
                                  <span class="dt">outcome.class=</span><span class="st">"survival"</span>,
                                  <span class="dt">outcome.var=</span><span class="kw">c</span>(<span class="st">"PFS"</span>,<span class="st">"PFS.event"</span>),
                                  <span class="dt">trt=</span><span class="st">"Arm"</span>,
                                  <span class="dt">var=</span><span class="st">"KRAS.exprs"</span>, 
                                  <span class="dt">var.class=</span><span class="st">"numeric"</span>,
                                  <span class="dt">percentile.cutoff=</span><span class="kw">c</span>(.<span class="dv">25</span>,.<span class="dv">5</span>,.<span class="dv">75</span>), 
                                  <span class="dt">greater=</span><span class="ot">TRUE</span>, <span class="dt">less=</span><span class="ot">FALSE</span>,
                                  <span class="dt">show.itt=</span><span class="ot">TRUE</span>, <span class="dt">show.bep=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Some NAs in var column, will define the non NA entries as BEP</code></pre>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-11-1.png" width="960"></p>
</div>
<div id="estimations-within-non-overlapping-bins" class="section level4">
<h4 class="hasAnchor">
<a href="#estimations-within-non-overlapping-bins" class="anchor"></a>Estimations within non-overlapping bins</h4>
<p>Function  can also be used to calculate trt/ctrl HR within percentile bins. For example, by specifying , trt/ctrl HR of biomarker 0-25% group, 25-50% group, 50-75% group,and 75-100% group are calculated:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res.withinbin &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PlotTabForestBiomarker.html">PlotTabForestBiomarker</a></span>(<span class="dt">data=</span>input,
                                  <span class="dt">outcome.class=</span><span class="st">"survival"</span>,
                                  <span class="dt">outcome.var=</span><span class="kw">c</span>(<span class="st">"PFS"</span>,<span class="st">"PFS.event"</span>),
                                  <span class="dt">trt=</span><span class="st">"Arm"</span>,
                                  <span class="dt">var=</span><span class="st">"KRAS.exprs"</span>, 
                                  <span class="dt">var.class=</span><span class="st">"numeric"</span>,
                                  <span class="dt">percentile.cutoff=</span><span class="kw">c</span>(.<span class="dv">25</span>,.<span class="dv">5</span>,.<span class="dv">75</span>), 
                                  <span class="dt">within.bin=</span><span class="ot">TRUE</span>,
                                  <span class="dt">show.itt=</span><span class="ot">TRUE</span>, <span class="dt">show.bep=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Some NAs in var column, will define the non NA entries as BEP</code></pre>
<pre><code>## within.bin is TRUE, greater and less will be ignored</code></pre>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-12-1.png" width="960"></p>
</div>
<div id="estimations-within-overlapped-sliding-windows---stepp-plot" class="section level4">
<h4 class="hasAnchor">
<a href="#estimations-within-overlapped-sliding-windows---stepp-plot" class="anchor"></a>Estimations within overlapped sliding windows - STEPP plot</h4>
<p>STEPP refers to Subgroup Treatment Effect Pattern Plot and it investigates relationship between biomarker and treatment effect. Only continuous biomarkers are suitable for STEPP analysis. STEPP performs treatment effect estimation on overlapping subsets of patients defined according to the biomarker level. The default setting of run.STEPP slides subgroup windows by 5% for each step and the subgroup size is 25% of the whole population.</p>
<p>A monotone trend is expected to be seen for an ideal biomarker.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stepp.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PlotSTEPP.html">PlotSTEPP</a></span>(<span class="dt">data =</span> input,
          <span class="dt">outcome.var =</span> <span class="kw">c</span>(<span class="st">"PFS"</span>, <span class="st">"PFS.event"</span>),
          <span class="dt">outcome.class =</span> <span class="st">"survival"</span>,
          <span class="dt">trt =</span> <span class="st">"Arm"</span>,
          <span class="dt">var =</span> <span class="st">"KRAS.exprs"</span>,
          <span class="dt">placebo.code =</span> <span class="st">"CTRL"</span>,
          <span class="dt">active.code =</span> <span class="st">"TRT"</span>
) </code></pre></div>
<pre><code>## some NA in var column, will ignore NA entries</code></pre>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<p>Here we can see the trt/ctrl HR decreases as the biomarker expression increases.</p>
</div>
</div>
<div id="biomarker-subgroup-analysis-using-selected-cutoff" class="section level3">
<h3 class="hasAnchor">
<a href="#biomarker-subgroup-analysis-using-selected-cutoff" class="anchor"></a>Biomarker subgroup analysis (using selected cutoff)</h3>
<p>When a cutoff is selected, the following functions can be used to perfrom subgroups analysis. Suppose that we decided to use 100 as cutoff.</p>
<div id="estimations-within-each-subgroup" class="section level4">
<h4 class="hasAnchor">
<a href="#estimations-within-each-subgroup" class="anchor"></a>Estimations within each subgroup</h4>
<p> function can again be used to estimate the treatment effect in biomarker subgroups. Here given that we have a numerical cutoff, it can be specified using parameter . And  can be left as NULL.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res.subgroups.cut &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PlotTabForestBiomarker.html">PlotTabForestBiomarker</a></span>(<span class="dt">data=</span>input,
                                  <span class="dt">outcome.class=</span><span class="st">"survival"</span>,
                                  <span class="dt">outcome.var=</span><span class="kw">c</span>(<span class="st">"PFS"</span>,<span class="st">"PFS.event"</span>),
                                  <span class="dt">trt=</span><span class="st">"Arm"</span>,
                                  <span class="dt">var=</span><span class="st">"KRAS.exprs"</span>, 
                                  <span class="dt">var.class=</span><span class="st">"numeric"</span>,
                                  <span class="dt">percentile.cutoff=</span><span class="ot">NULL</span>,
                                  <span class="dt">numerical.cutoff=</span><span class="dv">100</span>, <span class="dt">within.bin=</span><span class="ot">TRUE</span>,
                                  <span class="dt">show.itt=</span><span class="ot">TRUE</span>, <span class="dt">show.bep=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Some NAs in var column, will define the non NA entries as BEP</code></pre>
<pre><code>## within.bin is TRUE, greater and less will be ignored</code></pre>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-14-1.png" width="768"></p>
<p>This can also be done by converting the continuous marker to a binary variable:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">input$KRAS.exprs.2group &lt;-<span class="st"> </span><span class="kw">ifelse</span>(input$KRAS.exprs &gt;=<span class="st"> </span><span class="dv">100</span>, <span class="st">"&gt;=100"</span>,<span class="st">"&lt;100"</span>)
input$KRAS.exprs.2group &lt;-<span class="st"> </span><span class="kw">factor</span>(input$KRAS.exprs.2group, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">"&gt;=100"</span>,<span class="st">"&lt;100"</span>)) <span class="co"># "&gt;=100" as Dx+</span>
res.subgroups.bi &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PlotTabForestBiomarker.html">PlotTabForestBiomarker</a></span>(<span class="dt">data=</span>input,
                                  <span class="dt">outcome.class=</span><span class="st">"survival"</span>,
                                  <span class="dt">outcome.var=</span><span class="kw">c</span>(<span class="st">"PFS"</span>,<span class="st">"PFS.event"</span>),
                                  <span class="dt">trt=</span><span class="st">"Arm"</span>,
                                  <span class="dt">var=</span><span class="st">"KRAS.exprs.2group"</span>, 
                                  <span class="dt">var.class=</span><span class="st">"categorical"</span>,
                                  <span class="dt">show.itt=</span><span class="ot">TRUE</span>, <span class="dt">show.bep=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Some NAs in var column, will define the non NA entries as BEP</code></pre>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-15-1.png" width="960"></p>
</div>
<div id="km-curves" class="section level4">
<h4 class="hasAnchor">
<a href="#km-curves" class="anchor"></a>KM curves</h4>
<p>Function  can be used to generate the KM curves of biomarker subgroups:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/PlotKM.html">PlotKM</a></span>(<span class="dt">data=</span>input, <span class="dt">tte=</span><span class="st">"PFS"</span>,<span class="dt">cen=</span><span class="st">"PFS.event"</span>, <span class="dt">bep=</span><span class="st">"BEP"</span>, 
             <span class="dt">main=</span><span class="st">"PFS BEP by treatment, by KRAS expression subgroups"</span>, 
             <span class="dt">var=</span><span class="kw">c</span>(<span class="st">"Arm"</span>,<span class="st">"KRAS.exprs.2group"</span>), <span class="dt">legend.loc=</span><span class="st">"topright"</span>,
       <span class="dt">plot.median=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## more than one elements in 'var', trt parameter will be ignored</code></pre>
<pre><code>## 'varlist' is specified, trt and var parameters will be ignored</code></pre>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-16-1.png" width="864"></p>
<pre><code>## [1] ""</code></pre>
</div>
<div id="check-whether-biomarker-subgroup-is-confounded-with-key-clinical-variables" class="section level4">
<h4 class="hasAnchor">
<a href="#check-whether-biomarker-subgroup-is-confounded-with-key-clinical-variables" class="anchor"></a>Check whether biomarker subgroup is confounded with key clinical variables</h4>
<p>Functions  and  can again be used to check whether the biomarker subgroup is confounded with clinical variable. Using sex variable as an exmaple, instead of checking whether the F/M percentage is comparable in the full population vs. BEP, here we check the F/M percentage is comparable in biomarker high and low group. To perform such analysis we can specify  as , and specify . By doing so the program will compare the “&gt;=100” group vs. others.</p>
<p></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">input.bep &lt;-<span class="st"> </span><span class="kw">subset</span>(input, BEP==<span class="dv">1</span>)
<span class="kw">kable</span>(
<span class="kw"><a href="../reference/SummaryVars.html">SummaryVars</a></span>(<span class="dt">data=</span>input.bep,<span class="dt">trt=</span><span class="st">'Arm'</span>, <span class="dt">subgroup=</span><span class="st">'KRAS.exprs.2group'</span>, <span class="dt">var=</span><span class="kw">c</span>(<span class="st">'Sex'</span>), 
       <span class="dt">var.class=</span><span class="st">"categorical"</span>, <span class="dt">subgroup.indicator=</span><span class="st">"&gt;=100"</span>,<span class="dt">compare.subgroup=</span><span class="ot">TRUE</span>, <span class="dt">subgroup.name=</span><span class="st">"exprs"</span>)
)</code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="left">exprs_&gt;=100(CTRL)</th>
<th align="left">exprs_&lt;100(CTRL)</th>
<th align="left">exprs_&gt;=100(TRT)</th>
<th align="left">exprs_&lt;100(TRT)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Sex</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td>Total</td>
<td align="left">28</td>
<td align="left">53</td>
<td align="left">71</td>
<td align="left">105</td>
</tr>
<tr class="odd">
<td>NA’s</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td>F</td>
<td align="left">15 (53.57%)</td>
<td align="left">24 (45.28%)</td>
<td align="left">36 (50.7%)</td>
<td align="left">54 (51.43%)</td>
</tr>
<tr class="odd">
<td>M</td>
<td align="left">13 (46.43%)</td>
<td align="left">29 (54.72%)</td>
<td align="left">35 (49.3%)</td>
<td align="left">51 (48.57%)</td>
</tr>
</tbody>
</table>
<p></p>
<p> function could be used to look at treatment effect in smaller subgroups defined by both biomarker and clinical variables. For example, if we are interested in the trt/ctrl HR in following groups: biomarker high Male; biomarker high female; biomarker low male; biomarker low female, etc. We may specify  as the biomarker variable, and  as the clinical variables of interest. By setting  and , the program will calculate the summary statistics within each subgroup. For numerical clinical variable, it will be dichotomized by its median.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res.subgroup.cov &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PlotTabForestMulti.html">PlotTabForestMulti</a></span>(<span class="dt">data=</span>input,
                                  <span class="dt">outcome.class=</span><span class="st">"survival"</span>,
                                  <span class="dt">outcome.var=</span><span class="kw">c</span>(<span class="st">"PFS"</span>,<span class="st">"PFS.event"</span>),
                                  <span class="dt">trt=</span><span class="st">"Arm"</span>,
                                  <span class="dt">var=</span><span class="kw">c</span>(<span class="st">"Sex"</span>,<span class="st">"Weight"</span>),
                   <span class="dt">compare.bep.itt=</span><span class="ot">FALSE</span>,
                   <span class="dt">compare.subgroup=</span><span class="ot">TRUE</span>,
                   <span class="dt">subgroup=</span><span class="st">"KRAS.exprs.2group"</span>
                   )</code></pre></div>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-18-1.png" width="960"></p>
<p>In this case, no treatment effect difference is observed between the Female vs. Male subgroups (as well as weight high &amp; low).</p>

</div>
</div>
</div>
<div id="continuous-biomarker-in-a-single-arm-study-with-survival-outcome" class="section level2">
<h2 class="hasAnchor">
<a href="#continuous-biomarker-in-a-single-arm-study-with-survival-outcome" class="anchor"></a>Continuous biomarker in a single-arm study with survival outcome</h2>
<p>We generate a data set with only patients from the treatment arm to mimic the case of single arm study:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">input.trt &lt;-<span class="st"> </span><span class="kw">subset</span>(input, Arm==<span class="st">"TRT"</span>)</code></pre></div>
<p>We use PFS as primary endpoint, KRAS.exprs as biomarker of interest. We only take the treat</p>
<div id="representativeness-selection-bias-of-biomarker-population-1" class="section level3">
<h3 class="hasAnchor">
<a href="#representativeness-selection-bias-of-biomarker-population-1" class="anchor"></a>Representativeness: Selection Bias of Biomarker Population</h3>
<div id="check-selection-bias-in-terms-of-key-clinical-variables-between-the-full-population-and-bep" class="section level4">
<h4 class="hasAnchor">
<a href="#check-selection-bias-in-terms-of-key-clinical-variables-between-the-full-population-and-bep" class="anchor"></a>Check selection bias in terms of key clinical variables, between the full population and BEP</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(
  <span class="kw"><a href="../reference/SummaryVars.html">SummaryVars</a></span>(<span class="dt">data=</span>input.trt, <span class="dt">trt=</span><span class="ot">NULL</span>, <span class="dt">subgroup=</span><span class="st">'BEP'</span>, <span class="dt">var=</span><span class="kw">c</span>(<span class="st">'Age'</span>,<span class="st">'Sex'</span>), 
       <span class="dt">var.class=</span><span class="kw">c</span>(<span class="st">'numeric'</span>,<span class="st">'categorical'</span>))
)</code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="left">All</th>
<th align="left">BEP</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Age</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td>N</td>
<td align="left">368</td>
<td align="left">176</td>
</tr>
<tr class="odd">
<td>Mean</td>
<td align="left">54.03</td>
<td align="left">54.42</td>
</tr>
<tr class="even">
<td>Median</td>
<td align="left">54</td>
<td align="left">54</td>
</tr>
<tr class="odd">
<td>Min-Max</td>
<td align="left">30…89</td>
<td align="left">33…89</td>
</tr>
<tr class="even">
<td>NA’s</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td>Sex</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td>Total</td>
<td align="left">368</td>
<td align="left">176</td>
</tr>
<tr class="odd">
<td>NA’s</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td>F</td>
<td align="left">184 (50%)</td>
<td align="left">90 (51.14%)</td>
</tr>
<tr class="odd">
<td>M</td>
<td align="left">184 (50%)</td>
<td align="left">86 (48.86%)</td>
</tr>
</tbody>
</table>
</div>
<div id="check-whether-the-clinical-outcome-in-bep-is-comparable-to-the-full-population-1" class="section level4">
<h4 class="hasAnchor">
<a href="#check-whether-the-clinical-outcome-in-bep-is-comparable-to-the-full-population-1" class="anchor"></a>Check whether the clinical outcome in BEP is comparable to the full population</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/CompareKM.html">CompareKM</a></span>(<span class="dt">data=</span>input.trt,<span class="dt">tte=</span><span class="st">'PFS'</span>, <span class="dt">cen=</span><span class="st">'PFS.event'</span>,<span class="dt">trt=</span><span class="ot">NULL</span>, <span class="dt">bep=</span><span class="st">'BEP'</span>)</code></pre></div>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-21-1.png" width="480"></p>
</div>
<div id="examine-whether-the-prognosticnull-trend-of-key-clinical-variables-holds-in-bep" class="section level4">
<h4 class="hasAnchor">
<a href="#examine-whether-the-prognosticnull-trend-of-key-clinical-variables-holds-in-bep" class="anchor"></a>Examine whether the prognostic/null trend of key clinical variables holds in BEP</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/PlotTabForestMulti.html">PlotTabForestMulti</a></span>(<span class="dt">data=</span>input.trt,
                                  <span class="dt">outcome.class=</span><span class="st">"survival"</span>,
                                  <span class="dt">outcome.var=</span><span class="kw">c</span>(<span class="st">"PFS"</span>,<span class="st">"PFS.event"</span>),
                                  <span class="dt">trt=</span><span class="ot">NULL</span>,
                                  <span class="dt">var=</span><span class="kw">c</span>(<span class="st">"Sex"</span>,<span class="st">"Weight"</span>),
                   <span class="dt">bep=</span><span class="st">"BEP"</span>,<span class="dt">bep.indicator=</span><span class="dv">1</span>, <span class="dt">compare.bep.itt=</span><span class="ot">TRUE</span>
                   )</code></pre></div>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-22-1.png" width="960"></p>
<p>Age is a prognostic factor in both the full population and BEP. Sex show stronger prognostic trend in BEP, but not in the full population.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">input.trt.bep &lt;-<span class="st"> </span><span class="kw">subset</span>(input.trt, BEP==<span class="dv">1</span>) <span class="co"># dataset with only BEP samples</span>

<span class="kw">kable</span>(
  <span class="kw"><a href="../reference/CoxTab.html">CoxTab</a></span>(<span class="dt">data=</span>input.trt,<span class="dt">tte=</span><span class="st">"PFS"</span>, <span class="dt">cens=</span><span class="st">"PFS.event"</span>,  <span class="dt">var=</span><span class="kw">c</span>(<span class="st">'Sex'</span>,<span class="st">"Weight"</span>), 
       <span class="dt">var.class=</span><span class="kw">c</span>(<span class="st">"categorical"</span>,<span class="st">"numeric"</span>)),
<span class="dt">caption=</span><span class="st">"the full population, model of Sex, Weight"</span>
)</code></pre></div>
<table class="table">
<caption>the full population, model of Sex, Weight</caption>
<thead><tr class="header">
<th></th>
<th align="left">HR</th>
<th align="left">CI.low</th>
<th align="left">CI.high</th>
<th align="left">p-value</th>
<th align="left">n.trt</th>
<th align="left">n.ref</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Sex (M/F)</td>
<td align="left">0.91</td>
<td align="left">0.69</td>
<td align="left">1.2</td>
<td align="left">0.49</td>
<td align="left">184</td>
<td align="left">184</td>
</tr>
<tr class="even">
<td>Weight</td>
<td align="left">1</td>
<td align="left">0.99</td>
<td align="left">1</td>
<td align="left">0.33</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(
  <span class="kw"><a href="../reference/CoxTab.html">CoxTab</a></span>(<span class="dt">data=</span>input.trt.bep,<span class="dt">tte=</span><span class="st">"PFS"</span>, <span class="dt">cens=</span><span class="st">"PFS.event"</span>,  <span class="dt">var=</span><span class="kw">c</span>(<span class="st">'Sex'</span>,<span class="st">"Weight"</span>), 
       <span class="dt">var.class=</span><span class="kw">c</span>(<span class="st">"categorical"</span>,<span class="st">"numeric"</span>)),
<span class="dt">caption=</span><span class="st">"BEP, model of Sex, Weight"</span>
)</code></pre></div>
<table class="table">
<caption>BEP, model of Sex, Weight</caption>
<thead><tr class="header">
<th></th>
<th align="left">HR</th>
<th align="left">CI.low</th>
<th align="left">CI.high</th>
<th align="left">p-value</th>
<th align="left">n.trt</th>
<th align="left">n.ref</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Sex (M/F)</td>
<td align="left">0.7</td>
<td align="left">0.46</td>
<td align="left">1.06</td>
<td align="left">0.09</td>
<td align="left">86</td>
<td align="left">90</td>
</tr>
<tr class="even">
<td>Weight</td>
<td align="left">0.99</td>
<td align="left">0.97</td>
<td align="left">1</td>
<td align="left">0.094</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="biomarker-property-and-association-with-clinical-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#biomarker-property-and-association-with-clinical-variables" class="anchor"></a>Biomarker property and association with clinical variables</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/PlotProperty.html">PlotProperty</a></span>(<span class="dt">data=</span>input.trt, <span class="dt">biomarker.var=</span><span class="st">"KRAS.exprs"</span>, <span class="dt">biomarker.class=</span><span class="st">"numeric"</span>,
             <span class="dt">var=</span><span class="kw">c</span>(<span class="st">"Sex"</span>, <span class="st">"Country"</span>), <span class="dt">var.class=</span><span class="kw">c</span>(<span class="st">"categorical"</span>, <span class="st">"categorical"</span>),
             <span class="dt">log2=</span><span class="ot">TRUE</span>, <span class="dt">par.param =</span> <span class="kw">list</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)))</code></pre></div>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-24-1.png" width="672"><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-24-2.png" width="672"></p>
</div>
<div id="biomarker-cutoff-explorationselection" class="section level3">
<h3 class="hasAnchor">
<a href="#biomarker-cutoff-explorationselection" class="anchor"></a>Biomarker cutoff exploration/selection</h3>
<div id="try-different-cutoffs---look-for-consistent-trend-1" class="section level4">
<h4 class="hasAnchor">
<a href="#try-different-cutoffs---look-for-consistent-trend-1" class="anchor"></a>Try different cutoffs - look for consistent trend</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res.multicut &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PlotTabForestBiomarker.html">PlotTabForestBiomarker</a></span>(<span class="dt">data=</span>input.trt,
                                  <span class="dt">outcome.class=</span><span class="st">"survival"</span>,
                                  <span class="dt">outcome.var=</span><span class="kw">c</span>(<span class="st">"PFS"</span>,<span class="st">"PFS.event"</span>),
                                  <span class="dt">trt=</span><span class="ot">NULL</span>,
                                  <span class="dt">var=</span><span class="st">"KRAS.exprs"</span>, 
                                  <span class="dt">var.class=</span><span class="st">"numeric"</span>,
                                  <span class="dt">percentile.cutoff=</span><span class="kw">c</span>(.<span class="dv">25</span>,.<span class="dv">5</span>,.<span class="dv">75</span>), 
                                  <span class="dt">greater=</span><span class="ot">TRUE</span>, <span class="dt">less=</span><span class="ot">FALSE</span>,
                                  <span class="dt">show.itt=</span><span class="ot">FALSE</span>, <span class="dt">show.bep=</span><span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## Some NAs in var column, will define the non NA entries as BEP</code></pre>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-25-1.png" width="768"></p>
<p>Within-bin analysis and STEPP are not available in single-arm analysis.</p>
</div>
</div>
<div id="biomarker-subgroup-analysis-using-selected-cutoff-1" class="section level3">
<h3 class="hasAnchor">
<a href="#biomarker-subgroup-analysis-using-selected-cutoff-1" class="anchor"></a>Biomarker subgroup analysis (using selected cutoff)</h3>
<div id="subgroup-analysis" class="section level4">
<h4 class="hasAnchor">
<a href="#subgroup-analysis" class="anchor"></a>Subgroup analysis</h4>
<p>Suppose the proposed cutoff is 100</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res.subgroups.cut &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PlotTabForestBiomarker.html">PlotTabForestBiomarker</a></span>(<span class="dt">data=</span>input.trt,
                                  <span class="dt">outcome.class=</span><span class="st">"survival"</span>,
                                  <span class="dt">outcome.var=</span><span class="kw">c</span>(<span class="st">"PFS"</span>,<span class="st">"PFS.event"</span>),
                                  <span class="dt">trt=</span><span class="ot">NULL</span>,
                                  <span class="dt">var=</span><span class="st">"KRAS.exprs"</span>, 
                                  <span class="dt">var.class=</span><span class="st">"numeric"</span>,
                                  <span class="dt">percentile.cutoff=</span><span class="ot">NULL</span>,
                                  <span class="dt">numerical.cutoff=</span><span class="dv">100</span>, 
                                  <span class="dt">greater=</span><span class="ot">TRUE</span>,<span class="dt">less=</span><span class="ot">FALSE</span>,
                                  <span class="dt">show.itt=</span><span class="ot">FALSE</span>, <span class="dt">show.bep=</span><span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## Some NAs in var column, will define the non NA entries as BEP</code></pre>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-26-1.png" width="768"></p>
<p>This can also be done by converting the continous marker to a binary variable</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">input.trt$KRAS.exprs.trt.2group &lt;-<span class="st"> </span><span class="kw">ifelse</span>(input.trt$KRAS.exprs &gt;=<span class="st"> </span><span class="dv">100</span>, <span class="st">"&gt;=100"</span>,<span class="st">"&lt;100"</span>)
input.trt$KRAS.exprs.2group &lt;-<span class="st"> </span><span class="kw">factor</span>(input.trt$KRAS.exprs.2group, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">"&gt;=100"</span>,<span class="st">"&lt;100"</span>)) <span class="co"># "&gt;=100" as Dx+</span>

res.subgroups.bi &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PlotTabForestBiomarker.html">PlotTabForestBiomarker</a></span>(<span class="dt">data=</span>input.trt,
                                  <span class="dt">outcome.class=</span><span class="st">"survival"</span>,
                                  <span class="dt">outcome.var=</span><span class="kw">c</span>(<span class="st">"PFS"</span>,<span class="st">"PFS.event"</span>),
                                  <span class="dt">trt=</span><span class="ot">NULL</span>,
                                  <span class="dt">var=</span><span class="st">"KRAS.exprs.trt.2group"</span>, 
                                  <span class="dt">var.class=</span><span class="st">"categorical"</span>,
                                  <span class="dt">show.itt=</span><span class="ot">FALSE</span>, <span class="dt">show.bep=</span><span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## Some NAs in var column, will define the non NA entries as BEP</code></pre>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-27-1.png" width="864"></p>
</div>
<div id="km-curves-1" class="section level4">
<h4 class="hasAnchor">
<a href="#km-curves-1" class="anchor"></a>KM curves</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/PlotKM.html">PlotKM</a></span>(<span class="dt">data=</span>input.trt, <span class="dt">tte=</span><span class="st">"PFS"</span>,<span class="dt">cen=</span><span class="st">"PFS.event"</span>, <span class="dt">bep=</span><span class="st">"BEP"</span>, 
             <span class="dt">main=</span><span class="st">"PFS in BEP, by KRAS expression subgroups, single arm"</span>, 
             <span class="dt">var=</span><span class="kw">c</span>(<span class="st">"KRAS.exprs.trt.2group"</span>), <span class="dt">legend.loc=</span><span class="st">"topright"</span>,
       <span class="dt">plot.median=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-28-1.png" width="672"></p>
<pre><code>## [1] ""</code></pre>
</div>
<div id="check-whether-biomarker-subgroup-is-confounded-with-clinical-variables" class="section level4">
<h4 class="hasAnchor">
<a href="#check-whether-biomarker-subgroup-is-confounded-with-clinical-variables" class="anchor"></a>Check whether biomarker subgroup is confounded with clinical variables</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">input.trt.bep &lt;-<span class="st"> </span><span class="kw">subset</span>(input.trt, BEP==<span class="dv">1</span>)
<span class="kw">kable</span>(
<span class="kw"><a href="../reference/SummaryVars.html">SummaryVars</a></span>(<span class="dt">data=</span>input.trt.bep,<span class="dt">trt=</span><span class="ot">NULL</span>, <span class="dt">subgroup=</span><span class="st">'KRAS.exprs.2group'</span>, <span class="dt">var=</span><span class="kw">c</span>(<span class="st">'Sex'</span>), 
       <span class="dt">var.class=</span><span class="st">"categorical"</span>, <span class="dt">subgroup.indicator=</span><span class="st">"&gt;=100"</span>,<span class="dt">compare.subgroup=</span><span class="ot">TRUE</span>, <span class="dt">subgroup.name=</span><span class="st">"exprs"</span>)
)</code></pre></div>
<table class="table">
<thead><tr class="header">
<th></th>
<th align="left">exprs_&gt;=100</th>
<th align="left">exprs_&lt;100</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Sex</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td>Total</td>
<td align="left">71</td>
<td align="left">105</td>
</tr>
<tr class="odd">
<td>NA’s</td>
<td align="left">0</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td>F</td>
<td align="left">36 (50.7%)</td>
<td align="left">54 (51.43%)</td>
</tr>
<tr class="odd">
<td>M</td>
<td align="left">35 (49.3%)</td>
<td align="left">51 (48.57%)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="categorical-biomarker-with-survival-outcome" class="section level2">
<h2 class="hasAnchor">
<a href="#categorical-biomarker-with-survival-outcome" class="anchor"></a>Categorical biomarker with survival outcome</h2>
<div id="two-arm-study" class="section level3">
<h3 class="hasAnchor">
<a href="#two-arm-study" class="anchor"></a>Two-arm study</h3>
<p>Analyses in section 4.1 can also be applied to categorial biomarker, except the cutoff exploration part (section 4.1.3).</p>
<p>For example, for categorical biomarker KRAS.mutant, the subgroup analysis can be performed using the  function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res.subgroups.cat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PlotTabForestBiomarker.html">PlotTabForestBiomarker</a></span>(<span class="dt">data=</span>input,
                                  <span class="dt">outcome.class=</span><span class="st">"survival"</span>,
                                  <span class="dt">outcome.var=</span><span class="kw">c</span>(<span class="st">"PFS"</span>,<span class="st">"PFS.event"</span>),
                                  <span class="dt">trt=</span><span class="st">"Arm"</span>,
                                  <span class="dt">var=</span><span class="st">"KRAS.mutant"</span>, 
                                  <span class="dt">var.class=</span><span class="st">"categorical"</span>,
                                  <span class="dt">show.itt=</span><span class="ot">TRUE</span>, <span class="dt">show.bep=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Some NAs in var column, will define the non NA entries as BEP</code></pre>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-30-1.png" width="864"></p>
<p>The forest plot above provides HR estimates across two arms</p>
</div>
<div id="single-arm-study" class="section level3">
<h3 class="hasAnchor">
<a href="#single-arm-study" class="anchor"></a>Single-arm study</h3>
<p>Similarly, most functions in section 4.2 can be applied to categorical biomarker analysis (except the cutoff exploration part in section 4.2.3). For example, taking the  data set which only contains patients from treatment arm:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res.subgroups.cat &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PlotTabForestBiomarker.html">PlotTabForestBiomarker</a></span>(<span class="dt">data=</span>input.trt,
                                  <span class="dt">outcome.class=</span><span class="st">"survival"</span>,
                                  <span class="dt">outcome.var=</span><span class="kw">c</span>(<span class="st">"PFS"</span>,<span class="st">"PFS.event"</span>),
                                  <span class="dt">trt=</span><span class="ot">NULL</span>,
                                  <span class="dt">var=</span><span class="st">"KRAS.mutant"</span>, 
                                  <span class="dt">var.class=</span><span class="st">"categorical"</span>)</code></pre></div>
<pre><code>## Some NAs in var column, will define the non NA entries as BEP</code></pre>
<pre><code>## only 1 arm; show.itt is set to FALSE</code></pre>
<pre><code>## only 1 arm; show.bep is set to FALSE</code></pre>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-31-1.png" width="864"></p>

</div>
</div>
<div id="categorical-outcome-e-g-response" class="section level2">
<h2 class="hasAnchor">
<a href="#categorical-outcome-e-g-response" class="anchor"></a>Categorical outcome (e.g. response)</h2>
<div id="check-selection-bias-in-terms-of-key-clinical-variables-between-full-population-and-bep-1" class="section level3">
<h3 class="hasAnchor">
<a href="#check-selection-bias-in-terms-of-key-clinical-variables-between-full-population-and-bep-1" class="anchor"></a>Check selection bias in terms of key clinical variables, between full population and BEP</h3>
<p>Majority of functions from section 4.1.1 can be directly applied on analyses of categorical endpoints.</p>
<p>Function  in section 4.1.1 can still be used to perform selection bias checking of clinical variables. To check whether clinical outcome in BEP is comparable to the full population, user can use function  when the clinical outcome is response assessment. The parameter  may be used to define order of the levels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Rsp.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PlotRspBar.html">PlotRspBar</a></span>(<span class="dt">data=</span>input, <span class="dt">outcome.var=</span><span class="st">"Response"</span>, <span class="dt">binary=</span><span class="ot">FALSE</span>,
<span class="dt">rsp.levels=</span><span class="kw">c</span>(<span class="st">"CR"</span>, <span class="st">"PR"</span>,<span class="st">"SD"</span>,<span class="st">"NON CR/PD"</span>, <span class="st">"PD"</span>,<span class="st">"NE"</span>),<span class="dt">trt=</span><span class="st">"Arm"</span>,
<span class="dt">compare.bep.itt=</span><span class="ot">TRUE</span>, <span class="dt">bep =</span> <span class="st">"BEP"</span>)</code></pre></div>
<pre><code>## entries with missing outcome.var are removed! 524 entries left</code></pre>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-32-1.png" width="672"></p>
<p>The summary statistics can be obtained by:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(Rsp.out$count,<span class="dt">caption=</span><span class="st">"count"</span>)</code></pre></div>
<table class="table">
<caption>count</caption>
<thead><tr class="header">
<th></th>
<th align="right">CR</th>
<th align="right">PR</th>
<th align="right">SD</th>
<th align="right">NON CR/PD</th>
<th align="right">PD</th>
<th align="right">NE</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Full:CTRL</td>
<td align="right">0</td>
<td align="right">14</td>
<td align="right">64</td>
<td align="right">22</td>
<td align="right">58</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>Full:TRT</td>
<td align="right">6</td>
<td align="right">90</td>
<td align="right">145</td>
<td align="right">49</td>
<td align="right">74</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>Full:All</td>
<td align="right">6</td>
<td align="right">104</td>
<td align="right">209</td>
<td align="right">71</td>
<td align="right">132</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td>BEP:CTRL</td>
<td align="right">0</td>
<td align="right">10</td>
<td align="right">30</td>
<td align="right">7</td>
<td align="right">30</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>BEP:TRT</td>
<td align="right">4</td>
<td align="right">41</td>
<td align="right">72</td>
<td align="right">27</td>
<td align="right">31</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td>BEP:All</td>
<td align="right">4</td>
<td align="right">51</td>
<td align="right">102</td>
<td align="right">34</td>
<td align="right">61</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(<span class="kw">round</span>(Rsp.out$perc,<span class="dv">2</span>), <span class="dt">caption=</span><span class="st">"percentage"</span>)</code></pre></div>
<table class="table">
<caption>percentage</caption>
<thead><tr class="header">
<th></th>
<th align="right">CR</th>
<th align="right">PR</th>
<th align="right">SD</th>
<th align="right">NON CR/PD</th>
<th align="right">PD</th>
<th align="right">NE</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Full:CTRL</td>
<td align="right">0.00</td>
<td align="right">0.09</td>
<td align="right">0.40</td>
<td align="right">0.14</td>
<td align="right">0.36</td>
<td align="right">0.01</td>
</tr>
<tr class="even">
<td>Full:TRT</td>
<td align="right">0.02</td>
<td align="right">0.25</td>
<td align="right">0.40</td>
<td align="right">0.13</td>
<td align="right">0.20</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td>Full:All</td>
<td align="right">0.01</td>
<td align="right">0.20</td>
<td align="right">0.40</td>
<td align="right">0.14</td>
<td align="right">0.25</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td>BEP:CTRL</td>
<td align="right">0.00</td>
<td align="right">0.13</td>
<td align="right">0.39</td>
<td align="right">0.09</td>
<td align="right">0.39</td>
<td align="right">0.00</td>
</tr>
<tr class="odd">
<td>BEP:TRT</td>
<td align="right">0.02</td>
<td align="right">0.23</td>
<td align="right">0.41</td>
<td align="right">0.15</td>
<td align="right">0.18</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td>BEP:All</td>
<td align="right">0.02</td>
<td align="right">0.20</td>
<td align="right">0.40</td>
<td align="right">0.13</td>
<td align="right">0.24</td>
<td align="right">0.00</td>
</tr>
</tbody>
</table>
<p>To plot counts instead of percentage, one can specify the  parameter to TRUE:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/PlotRspBar.html">PlotRspBar</a></span>(<span class="dt">data=</span>input, <span class="dt">outcome.var=</span><span class="st">"Response"</span>, <span class="dt">binary=</span><span class="ot">FALSE</span>,
<span class="dt">rsp.levels=</span><span class="kw">c</span>(<span class="st">"CR"</span>, <span class="st">"PR"</span>,<span class="st">"SD"</span>,<span class="st">"NON CR/PD"</span>, <span class="st">"PD"</span>,<span class="st">"NE"</span>),<span class="dt">trt=</span><span class="st">"Arm"</span>,
<span class="dt">compare.bep.itt=</span><span class="ot">TRUE</span>, <span class="dt">bep =</span> <span class="st">"BEP"</span>, <span class="dt">plot.count=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## entries with missing outcome.var are removed! 524 entries left</code></pre>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-35-1.png" width="672"></p>
<p>To summarize the response into two classes - responder vs. non-responder, user may set the parameter  to TRUE. Parameter  () can be used to define levels to be considered as responder (non-responder). Patients whose response outcome don’t fall into these defined levels will be elminated from the analysis.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Rsp.out<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PlotRspBar.html">PlotRspBar</a></span>(<span class="dt">data=</span>input, <span class="dt">outcome.var=</span><span class="st">"Response"</span>, <span class="dt">binary=</span><span class="ot">TRUE</span>,
<span class="dt">rsp.response =</span> <span class="kw">c</span>(<span class="st">"CR"</span>,<span class="st">"PR"</span>),
<span class="dt">rsp.nonresponse =</span> <span class="kw">c</span>(<span class="st">"SD"</span>, <span class="st">"PD"</span>,<span class="st">"NON CR/PD"</span>,<span class="st">"NE"</span>),<span class="dt">trt=</span><span class="st">"Arm"</span>,
<span class="dt">compare.bep.itt=</span><span class="ot">TRUE</span>, <span class="dt">bep =</span> <span class="st">"BEP"</span>)</code></pre></div>
<pre><code>## entries with missing outcome.var are removed! 524 entries left</code></pre>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-36-1.png" width="672"></p>
<p>The summary statistics can be obtained by:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(Rsp.out<span class="fl">.2</span>$count,<span class="dt">caption=</span><span class="st">"count"</span>)</code></pre></div>
<table class="table">
<caption>count</caption>
<thead><tr class="header">
<th></th>
<th align="right">Rsp</th>
<th align="right">non-Rsp</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Full:CTRL</td>
<td align="right">14</td>
<td align="right">145</td>
</tr>
<tr class="even">
<td>Full:TRT</td>
<td align="right">96</td>
<td align="right">269</td>
</tr>
<tr class="odd">
<td>Full:All</td>
<td align="right">110</td>
<td align="right">414</td>
</tr>
<tr class="even">
<td>BEP:CTRL</td>
<td align="right">10</td>
<td align="right">67</td>
</tr>
<tr class="odd">
<td>BEP:TRT</td>
<td align="right">45</td>
<td align="right">130</td>
</tr>
<tr class="even">
<td>BEP:All</td>
<td align="right">55</td>
<td align="right">197</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(<span class="kw">round</span>(Rsp.out<span class="fl">.2</span>$perc,<span class="dv">2</span>), <span class="dt">caption=</span><span class="st">"percentage"</span>)</code></pre></div>
<table class="table">
<caption>percentage</caption>
<thead><tr class="header">
<th></th>
<th align="right">Rsp</th>
<th align="right">non-Rsp</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Full:CTRL</td>
<td align="right">0.09</td>
<td align="right">0.91</td>
</tr>
<tr class="even">
<td>Full:TRT</td>
<td align="right">0.26</td>
<td align="right">0.74</td>
</tr>
<tr class="odd">
<td>Full:All</td>
<td align="right">0.21</td>
<td align="right">0.79</td>
</tr>
<tr class="even">
<td>BEP:CTRL</td>
<td align="right">0.13</td>
<td align="right">0.87</td>
</tr>
<tr class="odd">
<td>BEP:TRT</td>
<td align="right">0.26</td>
<td align="right">0.74</td>
</tr>
<tr class="even">
<td>BEP:All</td>
<td align="right">0.22</td>
<td align="right">0.78</td>
</tr>
</tbody>
</table>
<p>To plot counts instead of percentage, one can specify the  parameter to TRUE:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/PlotRspBar.html">PlotRspBar</a></span>(<span class="dt">data=</span>input, <span class="dt">outcome.var=</span><span class="st">"Response"</span>, <span class="dt">binary=</span><span class="ot">TRUE</span>,
<span class="dt">rsp.response =</span> <span class="kw">c</span>(<span class="st">"CR"</span>,<span class="st">"PR"</span>),
<span class="dt">rsp.nonresponse =</span> <span class="kw">c</span>(<span class="st">"SD"</span>, <span class="st">"PD"</span>,<span class="st">"NON CR/PD"</span>,<span class="st">"NE"</span>),<span class="dt">trt=</span><span class="st">"Arm"</span>,
<span class="dt">compare.bep.itt=</span><span class="ot">TRUE</span>, <span class="dt">bep =</span> <span class="st">"BEP"</span>, <span class="dt">plot.count =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## entries with missing outcome.var are removed! 524 entries left</code></pre>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-39-1.png" width="672"></p>
</div>
<div id="continuous-biomarker-in-a-two-arm-study" class="section level3">
<h3 class="hasAnchor">
<a href="#continuous-biomarker-in-a-two-arm-study" class="anchor"></a>Continuous biomarker in a two-arm study</h3>
<p>Most of functions in workflow in section 4.1 may be used in analyses of continuous biomarker in a 2-arm study with categorical response. The following sections show examples of categorical-response specific use cases</p>
<div id="check-within-arm-trend" class="section level4">
<h4 class="hasAnchor">
<a href="#check-within-arm-trend" class="anchor"></a>Check within-arm trend</h4>
<p>To check the within-arm trend associated with categorical outcome, user may use the same function  as in section 4.1.2.2. Instead of specifying outcome.class as “survival”, user can specify outcome.class as “binary”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">input.ctrl &lt;-<span class="st"> </span><span class="kw">subset</span>(input, Arm==<span class="st">"CTRL"</span>) ## Data with only ctrl samples
res.multicut.ctrl &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PlotTabForestBiomarker.html">PlotTabForestBiomarker</a></span>(<span class="dt">data=</span>input.ctrl,
                                  <span class="dt">outcome.class=</span><span class="kw">c</span>(<span class="st">"binary"</span>),
                                  <span class="dt">outcome.var=</span><span class="kw">c</span>(<span class="st">"Response"</span>),
                                  <span class="dt">rsp.cat =</span> <span class="ot">TRUE</span>,
                                  <span class="dt">rsp.response =</span> <span class="kw">c</span>(<span class="st">"CR"</span>,<span class="st">"PR"</span>),
                                  <span class="dt">rsp.nonresponse =</span> <span class="kw">c</span>(<span class="st">"SD"</span>, <span class="st">"PD"</span>,<span class="st">"NON CR/PD"</span>,<span class="st">"NE"</span>,<span class="ot">NA</span>),
                                  <span class="dt">var=</span><span class="st">"KRAS.exprs"</span>, 
                                  <span class="dt">var.class=</span><span class="st">"numeric"</span>,
                                  <span class="dt">percentile.cutoff=</span><span class="kw">c</span>(.<span class="dv">25</span>,.<span class="dv">5</span>,.<span class="dv">75</span>), <span class="dt">main.prefix=</span><span class="st">"CTRL"</span>,
                                  <span class="dt">greater=</span><span class="ot">TRUE</span>, <span class="dt">less=</span><span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## Covariate adjustment and stratification are not supported for binary outcome</code></pre>
<pre><code>## Some NAs in var column, will define the non NA entries as BEP</code></pre>
<pre><code>## only 1 arm; show.itt is set to FALSE</code></pre>
<pre><code>## only 1 arm; show.bep is set to FALSE</code></pre>
<pre><code>## Warning in prop.test(c(r1, r2), c(n1, n2), conf.level = 1 - alpha,
## correct = fit.para[["prop.test.use.continuity.correction"]]): Chi-squared
## approximation may be incorrect

## Warning in prop.test(c(r1, r2), c(n1, n2), conf.level = 1 - alpha,
## correct = fit.para[["prop.test.use.continuity.correction"]]): Chi-squared
## approximation may be incorrect</code></pre>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-40-1.png" width="768"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">input.trt &lt;-<span class="st"> </span><span class="kw">subset</span>(input, Arm==<span class="st">"TRT"</span>) ## Data with only trt samples
res.multicut.trt &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PlotTabForestBiomarker.html">PlotTabForestBiomarker</a></span>(<span class="dt">data=</span>input.trt,
                                  <span class="dt">outcome.class=</span><span class="kw">c</span>(<span class="st">"binary"</span>),
                                  <span class="dt">outcome.var=</span><span class="kw">c</span>(<span class="st">"Response"</span>),
                                  <span class="dt">rsp.cat =</span> <span class="ot">TRUE</span>,
                                  <span class="dt">rsp.response =</span> <span class="kw">c</span>(<span class="st">"CR"</span>,<span class="st">"PR"</span>),
                                  <span class="dt">rsp.nonresponse =</span> <span class="kw">c</span>(<span class="st">"SD"</span>, <span class="st">"PD"</span>,<span class="st">"NON CR/PD"</span>,<span class="st">"NE"</span>,<span class="ot">NA</span>),
                                  <span class="dt">var=</span><span class="st">"KRAS.exprs"</span>, 
                                  <span class="dt">var.class=</span><span class="st">"numeric"</span>,
                                  <span class="dt">percentile.cutoff=</span><span class="kw">c</span>(.<span class="dv">25</span>,.<span class="dv">5</span>,.<span class="dv">75</span>), <span class="dt">main.prefix=</span><span class="st">"TRT"</span>,
                                  <span class="dt">greater=</span><span class="ot">TRUE</span>, <span class="dt">less=</span><span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## Covariate adjustment and stratification are not supported for binary outcome</code></pre>
<pre><code>## Some NAs in var column, will define the non NA entries as BEP</code></pre>
<pre><code>## only 1 arm; show.itt is set to FALSE</code></pre>
<pre><code>## only 1 arm; show.bep is set to FALSE</code></pre>
<pre><code>## Warning in par(old.par): calling par(new=TRUE) with no plot</code></pre>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-40-2.png" width="768"></p>
<p>The summary statistics shown in the forest plot is</p>
<p>deltaRR = [Response Rate in biomarker high] - [Response Rate in biomarker low]</p>
<p>To calculate the response rate, user needs to binarize the response classes into two classes.</p>
<p>Parameter  () can be used to define levels to be considered as responder (non-responder). Patients whose response outcome don’t fall into these defined levels will be elminated from the analysis.</p>
<p>In both arms, we observe that patients with higher expression tend to have higher response rate. This indicates that in terms of response, KRAS.exprs shows prognostic trend.</p>
</div>
<div id="seeking-for-predictive-trend-cutoff-explorationselection" class="section level4">
<h4 class="hasAnchor">
<a href="#seeking-for-predictive-trend-cutoff-explorationselection" class="anchor"></a>Seeking for predictive trend: cutoff exploration/selection</h4>
<p>Similar to the example in section 4.1.3,</p>
<p>function  also can be used for cutoff exploration.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res.multicut.2arm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PlotTabForestBiomarker.html">PlotTabForestBiomarker</a></span>(<span class="dt">data=</span>input,
                                  <span class="dt">outcome.class=</span><span class="kw">c</span>(<span class="st">"binary"</span>),
                                  <span class="dt">outcome.var=</span><span class="kw">c</span>(<span class="st">"Response"</span>),
                                  <span class="dt">trt =</span> <span class="st">"Arm"</span>,
                                  <span class="dt">rsp.cat =</span> <span class="ot">TRUE</span>,
                                  <span class="dt">rsp.response =</span> <span class="kw">c</span>(<span class="st">"CR"</span>,<span class="st">"PR"</span>),
                                  <span class="dt">rsp.nonresponse =</span> <span class="kw">c</span>(<span class="st">"SD"</span>, <span class="st">"PD"</span>,<span class="st">"NON CR/PD"</span>,<span class="st">"NE"</span>,<span class="ot">NA</span>),
                                  <span class="dt">var=</span><span class="st">"KRAS.exprs"</span>, 
                                  <span class="dt">var.class=</span><span class="st">"numeric"</span>,
                                  <span class="dt">percentile.cutoff=</span><span class="kw">c</span>(.<span class="dv">25</span>,.<span class="dv">5</span>,.<span class="dv">75</span>),
                                  <span class="dt">greater=</span><span class="ot">TRUE</span>, <span class="dt">less=</span><span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## Covariate adjustment and stratification are not supported for binary outcome</code></pre>
<pre><code>## Some NAs in var column, will define the non NA entries as BEP</code></pre>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-41-1.png" width="960"></p>
<p>In across-arm analysis, for a given subgroup, the delta RR is calculated as [Response Rate in treatment] - [Response Rate in control]</p>
<p>From the figure above, we can observe that no matter where we set the biomarker cutoff, the biomarker high group always shows similar delta RR as the BEP delta RR (as well as full population delta RR)</p>
<p>We can further examine the predictive trend by looking at the within-bin analysis:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res.multicut.2arm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PlotTabForestBiomarker.html">PlotTabForestBiomarker</a></span>(<span class="dt">data=</span>input,
                                  <span class="dt">outcome.class=</span><span class="kw">c</span>(<span class="st">"binary"</span>),
                                  <span class="dt">outcome.var=</span><span class="kw">c</span>(<span class="st">"Response"</span>),
                                  <span class="dt">trt =</span> <span class="st">"Arm"</span>,
                                  <span class="dt">rsp.cat =</span> <span class="ot">TRUE</span>,
                                  <span class="dt">rsp.response =</span> <span class="kw">c</span>(<span class="st">"CR"</span>,<span class="st">"PR"</span>),
                                  <span class="dt">rsp.nonresponse =</span> <span class="kw">c</span>(<span class="st">"SD"</span>, <span class="st">"PD"</span>,<span class="st">"NON CR/PD"</span>,<span class="st">"NE"</span>,<span class="ot">NA</span>),
                                  <span class="dt">var=</span><span class="st">"KRAS.exprs"</span>, 
                                  <span class="dt">var.class=</span><span class="st">"numeric"</span>,
                                  <span class="dt">percentile.cutoff=</span><span class="kw">c</span>(.<span class="dv">25</span>,.<span class="dv">5</span>,.<span class="dv">75</span>),
                                  <span class="dt">within.bin=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Covariate adjustment and stratification are not supported for binary outcome</code></pre>
<pre><code>## Some NAs in var column, will define the non NA entries as BEP</code></pre>
<pre><code>## within.bin is TRUE, greater and less will be ignored</code></pre>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-42-1.png" width="960"></p>
<p>This indicates that there is no clear predictive trend in terms of the response outcome - the result doesn’t show that the higher (lower) the expression, the more benefit in treatment arm compare to control arm.</p>
</div>
<div id="subgroup-analysis-1" class="section level4">
<h4 class="hasAnchor">
<a href="#subgroup-analysis-1" class="anchor"></a>Subgroup analysis</h4>
<p>Suppose that we are interested in looking at subgroup analysis using cutoff = 100, function  can again be used to perform the subgroup analysis. To do so, user can input the dichotomized biomarker variable into parameter , and specify </p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">input$KRAS.exprs.2group &lt;-<span class="st"> </span><span class="kw">ifelse</span>(input$KRAS.exprs &gt;=<span class="st"> </span><span class="dv">100</span>, <span class="st">"&gt;=100"</span>,<span class="st">"&lt;100"</span>)
input$KRAS.exprs.2group &lt;-<span class="st"> </span><span class="kw">factor</span>(input$KRAS.exprs.2group, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">"&gt;=100"</span>,<span class="st">"&lt;100"</span>)) <span class="co"># "&gt;=100" as Dx+</span>
Rsp.out<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PlotRspBar.html">PlotRspBar</a></span>(<span class="dt">data=</span>input, <span class="dt">outcome.var=</span><span class="st">"Response"</span>, <span class="dt">binary=</span><span class="ot">TRUE</span>,
<span class="dt">rsp.response =</span> <span class="kw">c</span>(<span class="st">"CR"</span>,<span class="st">"PR"</span>),
<span class="dt">rsp.nonresponse =</span> <span class="kw">c</span>(<span class="st">"SD"</span>, <span class="st">"PD"</span>,<span class="st">"NON CR/PD"</span>,<span class="st">"NE"</span>),<span class="dt">trt=</span><span class="st">"Arm"</span>,
 <span class="dt">bep =</span> <span class="st">"BEP"</span>,<span class="dt">compare.var=</span><span class="ot">TRUE</span>, <span class="dt">var=</span><span class="st">"KRAS.exprs.2group"</span>)</code></pre></div>
<pre><code>## entries with missing outcome.var are removed! 524 entries left</code></pre>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-43-1.png" width="672"></p>
<p>The subgroup analysis again confirmed the prognostic effect - when biomarker is high (&gt;=100), patients in both TRT and CTRL arms have improved response outcome.</p>
<p>Compare to results shown in section 4.1, we see that teh KRAS.exprs show predictive trend in terms of PFS, but prognostic trend in terms of response outcome. Although those results are based on simulated data, in empirical study it is also possible that the biomarker shows different trend when associating to different endpoints (e.g. response vs. PFS, PFS vs. OS, investigator PFS vs. IRF PFS). Therefore when analyzing biomarker data, it is important to make sure the analysis is using appropriate endpoint.</p>
</div>
</div>
<div id="other-scenarios" class="section level3">
<h3 class="hasAnchor">
<a href="#other-scenarios" class="anchor"></a>Other scenarios</h3>
<div id="continuous-biomarker-in-a-single-arm-study" class="section level4">
<h4 class="hasAnchor">
<a href="#continuous-biomarker-in-a-single-arm-study" class="anchor"></a>Continuous biomarker in a single-arm study</h4>
<p>See section 4.2 and section 4.4.2</p>
</div>
<div id="categorical-biomarker-in-a-two-arm-study" class="section level4">
<h4 class="hasAnchor">
<a href="#categorical-biomarker-in-a-two-arm-study" class="anchor"></a>Categorical biomarker in a two-arm study</h4>
<p>See section 4.3.1 and section 4.4.2</p>
</div>
<div id="categorical-biomarker-in-a-single-arm-study" class="section level4">
<h4 class="hasAnchor">
<a href="#categorical-biomarker-in-a-single-arm-study" class="anchor"></a>Categorical biomarker in a single-arm study</h4>
<p>See section 4.3.2 and section 4.4.2</p>
</div>
</div>
</div>
<div id="continuous-outcome" class="section level2">
<h2 class="hasAnchor">
<a href="#continuous-outcome" class="anchor"></a>Continuous outcome</h2>
<p>The similar workflow can be applied to cases with continuous endpoint.</p>
<p>For example, function  can also be used for continuous endpoint. Using Lab_ontrt as continuous surrogate endpoint:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res.multicut &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PlotTabForestBiomarker.html">PlotTabForestBiomarker</a></span>(<span class="dt">data=</span>input,
                                  <span class="dt">outcome.class=</span><span class="st">"continuous"</span>,
                                  <span class="dt">outcome.var=</span><span class="st">"Lab_ontrt"</span>,
                                  <span class="dt">trt=</span><span class="st">"Arm"</span>,
                                  <span class="dt">var=</span><span class="st">"KRAS.exprs"</span>, 
                                  <span class="dt">var.class=</span><span class="st">"numeric"</span>,
                                  <span class="dt">percentile.cutoff=</span><span class="kw">c</span>(.<span class="dv">25</span>,.<span class="dv">5</span>,.<span class="dv">75</span>), 
                                  <span class="dt">greater=</span><span class="ot">TRUE</span>, <span class="dt">less=</span><span class="ot">FALSE</span>,
                                  <span class="dt">show.itt=</span><span class="ot">TRUE</span>, <span class="dt">show.bep=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Stratification is not supported for continuous outcome</code></pre>
<pre><code>## Some NAs in var column, will define the non NA entries as BEP</code></pre>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-44-1.png" width="672"></p>
<p>The forest plot above shows the difference in mean between treatment arm and control arm.</p>
<p>Function  can also be used for continuous endpoint:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stepp.out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PlotSTEPP.html">PlotSTEPP</a></span>(<span class="dt">data =</span> input,
          <span class="dt">outcome.var =</span> <span class="st">"Lab_ontrt"</span>,
          <span class="dt">outcome.class =</span> <span class="st">"continuous"</span>,
          <span class="dt">trt =</span> <span class="st">"Arm"</span>,
          <span class="dt">var =</span> <span class="st">"KRAS.exprs"</span>,
          <span class="dt">placebo.code =</span> <span class="st">"CTRL"</span>,
          <span class="dt">active.code =</span> <span class="st">"TRT"</span>
) </code></pre></div>
<pre><code>## some NA in var column, will ignore NA entries</code></pre>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-45-1.png" width="672"></p>
</div>
<div id="longitudinal-analysis-e-g-pd-biomarker" class="section level2">
<h2 class="hasAnchor">
<a href="#longitudinal-analysis-e-g-pd-biomarker" class="anchor"></a>Longitudinal analysis (e.g. PD biomarker)</h2>
<div id="longitudinal-sample-data-longbmkr" class="section level3">
<h3 class="hasAnchor">
<a href="#longitudinal-sample-data-longbmkr" class="anchor"></a>Longitudinal Sample Data (<code>longbmkr</code>)</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(longbmkr)</code></pre></div>
<pre><code>## # A tibble: 6 x 8
##     pid    trt    sex      age   edu     bmkr    vm       ep
##   &lt;int&gt; &lt;fctr&gt; &lt;fctr&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
## 1     1      1      m 33.74524    17 2.039438     0 189.4929
## 2     1      1      m 33.74524    17 2.039438     6 220.8376
## 3     1      1      m 33.74524    17 2.039438    12 229.2280
## 4     1      1      m 33.74524    17 2.039438    18 246.0740
## 5     1      1      m 33.74524    17 2.039438    24 319.4606
## 6     1      1      m 33.74524    17 2.039438    30 274.8363</code></pre>
<table class="table">
<caption>Longitudinal Biomarker Sample Data</caption>
<thead><tr class="header">
<th align="left">Column Name</th>
<th align="left">English Name</th>
<th align="left">Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">pid</td>
<td align="left">PatientID</td>
<td align="left">Unique Patient Identifier</td>
</tr>
<tr class="even">
<td align="left">trt</td>
<td align="left">Treatment</td>
<td align="left">Binary Classification of Treatment (1) or Control (0)</td>
</tr>
<tr class="odd">
<td align="left">sex</td>
<td align="left">Sex</td>
<td align="left">Male (“m”) or Female (“f”) binary classification of sex</td>
</tr>
<tr class="even">
<td align="left">age</td>
<td align="left">Age</td>
<td align="left">Age of Patient</td>
</tr>
<tr class="odd">
<td align="left">edu</td>
<td align="left">Education</td>
<td align="left">Years of Education for the Patient</td>
</tr>
<tr class="even">
<td align="left">bmkr</td>
<td align="left">Biomarker Measurement</td>
<td align="left">Biomarker Measurement|Mock Biomarker Measurement Reading</td>
</tr>
<tr class="odd">
<td align="left">vm</td>
<td align="left">Visitation Month</td>
<td align="left">Timepoint that data was collected</td>
</tr>
<tr class="even">
<td align="left">ep</td>
<td align="left">Endpoint Measurement</td>
<td align="left">Mock Endpoint Measurement Reading</td>
</tr>
</tbody>
</table>
</div>
<div id="baseline-plots-of-subsetted-longitudinal-data" class="section level3">
<h3 class="hasAnchor">
<a href="#baseline-plots-of-subsetted-longitudinal-data" class="anchor"></a>Baseline Plots of Subsetted Longitudinal Data</h3>
<p>The baseline data for longitudinal data can be accessed by subsetting the data for only the visitation that took place at month 0. This can be done in a couple ways. In base-R (without any extra packages), this can be done by slicing the data on the condition.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">baseline_data &lt;-<span class="st"> </span>longbmkr[longbmkr[<span class="st">'vm'</span>] ==<span class="st"> </span><span class="dv">0</span>,]

<span class="kw">kable</span>(
    <span class="kw">head</span>(baseline_data),
    <span class="dt">caption =</span> <span class="st">'longitudinal data subset by visit month to produce baseline data'</span>
)</code></pre></div>
<table class="table">
<caption>longitudinal data subset by visit month to produce baseline data</caption>
<thead><tr class="header">
<th align="right">pid</th>
<th align="left">trt</th>
<th align="left">sex</th>
<th align="right">age</th>
<th align="right">edu</th>
<th align="right">bmkr</th>
<th align="right">vm</th>
<th align="right">ep</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">1</td>
<td align="left">m</td>
<td align="right">33.74524</td>
<td align="right">17</td>
<td align="right">2.0394381</td>
<td align="right">0</td>
<td align="right">189.4929</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">1</td>
<td align="left">m</td>
<td align="right">48.89196</td>
<td align="right">15</td>
<td align="right">0.9767885</td>
<td align="right">0</td>
<td align="right">217.5700</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">0</td>
<td align="left">m</td>
<td align="right">31.64887</td>
<td align="right">9</td>
<td align="right">1.2560775</td>
<td align="right">0</td>
<td align="right">230.4638</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="left">0</td>
<td align="left">f</td>
<td align="right">49.99146</td>
<td align="right">10</td>
<td align="right">2.2387438</td>
<td align="right">0</td>
<td align="right">181.7519</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="left">0</td>
<td align="left">m</td>
<td align="right">34.35769</td>
<td align="right">10</td>
<td align="right">3.0002676</td>
<td align="right">0</td>
<td align="right">199.1143</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="left">1</td>
<td align="left">f</td>
<td align="right">48.05002</td>
<td align="right">9</td>
<td align="right">1.1909059</td>
<td align="right">0</td>
<td align="right">185.8253</td>
</tr>
</tbody>
</table>
<p>Baseline data from longitudinal data can be used for any of the plots described herein similar to the examples above.</p>
</div>
<div id="longitudinal-plots-with-plotlong" class="section level3">
<h3 class="hasAnchor">
<a href="#longitudinal-plots-with-plotlong" class="anchor"></a>Longitudinal Plots with <code>PlotLong</code>
</h3>
<p>The <code>PlotLong</code> function is called with only a small set of arguments. The first is the data to plot and the second is an aesthetic mapping (using the function <code>aes()</code>) to map columns to visual outputs. In it’s most simple form, you can plot the distribution of endpoint readings over the timecourse, for the entire patient population. By default, the <code>PlotLong</code> function plots a line with points at the timepoints for which data exists with a ribbon showing the mean ± standard error at that timestamp.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/PlotLong.html">PlotLong</a></span>(longbmkr, <span class="dt">x=</span>vm, <span class="dt">y=</span>ep)</code></pre></div>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-48-1.png" width="672"></p>
<div id="tukey-hinges-and-whiskers" class="section level4">
<h4 class="hasAnchor">
<a href="#tukey-hinges-and-whiskers" class="anchor"></a>Tukey Hinges and Whiskers</h4>
<p>However, we may be more interested in the population distribution progression where we’d want to plot the Tukey boxplot hinges and whiskers over time. From this plot, we can see that although there is a slow rise in population mean, the patient response also becomes more distributed. You can specify, using the <code>fun.data</code> argument, exactly what the ribbons represent by using any keyword that can be passed to <code>stat_summary_funs</code> including “mean_sd” (mean ± standard deviation), “mean_sd” (mean ± standard error of the mean), “median_iqr” (median ± interquartile range), “tukey” (tukey boxplot hinges and whiskers), “quartiles” and “deciles”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/PlotLong.html">PlotLong</a></span>(longbmkr, <span class="dt">x=</span>vm, <span class="dt">y=</span>ep, <span class="dt">fun.data =</span> <span class="st">'tukey'</span>,
         <span class="dt">xlab =</span> <span class="st">'Visitation Month'</span>,
         <span class="dt">ylab =</span> <span class="st">'Biomarker Endpoint'</span>,
         <span class="dt">labs.title =</span> <span class="st">'Tukey Whiskers and Hinges'</span>)</code></pre></div>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-49-1.png" width="672"></p>
</div>
<div id="plotting-subpopulations-two-armed-trials" class="section level4">
<h4 class="hasAnchor">
<a href="#plotting-subpopulations-two-armed-trials" class="anchor"></a>Plotting Subpopulations (Two-Armed Trials)</h4>
<p>By giving aesthetic mappings to flags for subpopulations, you can easily vary the colors by adding aesthetics. In this case, we map the line color and ribbon fill to the treatment arm data, allowing a two arm trial representation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/PlotLong.html">PlotLong</a></span>(longbmkr, <span class="dt">x=</span>vm, <span class="dt">y=</span>ep, <span class="dt">color=</span>trt, <span class="dt">fill=</span>trt, 
         <span class="dt">fun.data =</span> <span class="st">'tukey'</span>,
         <span class="dt">xlab =</span> <span class="st">'Visitation Month'</span>,
         <span class="dt">ylab =</span> <span class="st">'Biomarker Endpoint'</span>,
         <span class="dt">labs.title =</span> <span class="st">'Biomarker Timecourse'</span>,
         <span class="dt">labs.caption =</span> <span class="st">'Ribbons represent Tukey hinges and whiskers'</span>)</code></pre></div>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-50-1.png" width="672"></p>
<p>Similarly, we could also choose to subset our treatment arms by sex and represent this as two separate plots, one for each sex classification. In this case, we facet the plot by a formula (which is passed to <code>ggplot::facet_grid()</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/PlotLong.html">PlotLong</a></span>(longbmkr, <span class="dt">x=</span>vm, <span class="dt">y=</span>ep, <span class="dt">group=</span>trt, <span class="dt">color=</span>trt, <span class="dt">fill=</span>trt, 
         <span class="dt">fun.data =</span> <span class="st">'tukey'</span>, <span class="dt">facet.fun =</span> . ~<span class="st"> </span>sex,
         <span class="dt">xlab =</span> <span class="st">'Visitation Month'</span>,
         <span class="dt">ylab =</span> <span class="st">'Biomarker Endpoint'</span>,
         <span class="dt">labs.title =</span> <span class="st">'Biomarker Timecourse'</span>,
         <span class="dt">labs.caption =</span> <span class="st">'Ribbons represent Tukey hinges and whiskers'</span>)</code></pre></div>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-51-1.png" width="672"></p>
</div>
<div id="including-sample-counts" class="section level4">
<h4 class="hasAnchor">
<a href="#including-sample-counts" class="anchor"></a>Including sample counts</h4>
<p>The <code>PlotLong</code> function also accepts inputs to the argument <code>show.counts</code>, accepting either “label” or “table”. This is used to represent sample number in each timepoint, for each grouping. For this and the followign plots, we’ll do some preprocessing for which we’ll use the <code>dplyr</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)</code></pre></div>
<pre><code>## 
## Attaching package: 'dplyr'</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cutoff =<span class="st"> </span><span class="fl">1.5</span>

longbmkr %&gt;%
<span class="st">    </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(vm &lt;=<span class="st"> </span><span class="dv">24</span>) %&gt;%
<span class="st">    </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">bmkr =</span> <span class="kw">ifelse</span>(bmkr &gt;<span class="st"> </span>cutoff, <span class="st">'Positive'</span>, <span class="st">'Negative'</span>)) %&gt;%
<span class="st">    </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">trt  =</span> <span class="kw">ifelse</span>(trt ==<span class="st"> </span><span class="dv">0</span>, <span class="st">'CTRL'</span>, <span class="st">'TRT'</span>)) %&gt;%
<span class="st">    </span>
<span class="st">    </span><span class="kw"><a href="../reference/PlotLong.html">PlotLong</a></span>(<span class="dt">x=</span>vm, <span class="dt">y=</span>ep, <span class="dt">color=</span>trt, <span class="dt">fill=</span>trt, <span class="dt">linetype=</span>bmkr,
             <span class="dt">fun.data =</span> <span class="st">'mean_se'</span>,
             <span class="dt">show.counts =</span> <span class="st">'table'</span>,
             <span class="dt">plot.style =</span> <span class="st">'errorbars'</span>,
             <span class="dt">errorbar.linetype =</span> <span class="dv">1</span>,
             <span class="dt">xlab =</span> <span class="st">'Visitation Month'</span>,
             <span class="dt">ylab =</span> <span class="st">'Endpoint'</span>,
             <span class="dt">labs.title =</span> <span class="st">'Biomarker Timecourse'</span>,
             <span class="dt">labs.caption =</span> <span class="st">'*ribbons represent mean value ± standard error of the mean.'</span>)</code></pre></div>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-53-1.png" width="672"></p>
</div>
<div id="specifying-a-function-for-adjustment" class="section level4">
<h4 class="hasAnchor">
<a href="#specifying-a-function-for-adjustment" class="anchor"></a>Specifying a function for adjustment</h4>
<p>(Currently a work-in-progress!)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cutoff =<span class="st"> </span><span class="fl">1.5</span>

longbmkr %&gt;%
<span class="st">    </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(vm &lt;=<span class="st"> </span><span class="dv">24</span>) %&gt;%
<span class="st">    </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">bmkr =</span> <span class="kw">ifelse</span>(bmkr &gt;<span class="st"> </span>cutoff, <span class="st">'Positive'</span>, <span class="st">'Negative'</span>)) %&gt;%
<span class="st">    </span><span class="kw"><a href="http://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">trt  =</span> <span class="kw">ifelse</span>(trt ==<span class="st"> </span><span class="dv">0</span>, <span class="st">'CTRL'</span>, <span class="st">'TRT'</span>)) %&gt;%
<span class="st">    </span>
<span class="st">    </span><span class="kw"><a href="../reference/PlotLong.html">PlotLong</a></span>(<span class="dt">x=</span>vm, <span class="dt">y=</span>ep, <span class="dt">color=</span>trt, <span class="dt">fill=</span>trt, <span class="dt">linetype=</span>bmkr,
             <span class="dt">model =</span> lm,
             <span class="dt">model.formula =</span> ep ~<span class="st"> </span>sex +<span class="st"> </span>edu +<span class="st"> </span>age, 
             <span class="dt">fun.data =</span> <span class="st">'mean_se'</span>,
             <span class="dt">show.counts =</span> <span class="st">'table'</span>,
             <span class="dt">plot.style =</span> <span class="st">'errorbars'</span>,
             <span class="dt">errorbar.linetype =</span> <span class="dv">1</span>,
             <span class="dt">xlab =</span> <span class="st">'Visitation Month'</span>,
             <span class="dt">ylab =</span> <span class="st">'Endpoint'</span>,
             <span class="dt">labs.title =</span> <span class="st">'Biomarker Timecourse'</span>,
             <span class="dt">labs.caption =</span> <span class="st">'*ribbons represent mean value ± standard error of the mean.'</span>)</code></pre></div>
<p><img src="gClinbiomarker_vig_v1_files/figure-html/unnamed-chunk-54-1.png" width="672"></p>
</div>
</div>
</div>
</div>
<div id="acknowledgement" class="section level1">
<h1 class="hasAnchor">
<a href="#acknowledgement" class="anchor"></a>Acknowledgement</h1>
<p>We would like to thank Imola Fodor, Jane Zhenya Fridlyand and Zhuoye Xu for sponsoring this project. We would also like to thank to all previous developers of this project (Ru-Fang Yeh, Yuanyuan Xiao, YJ Choi, Ron Yu, Yuda Zhu, Jayantha Ratnayake, Sofia Mosesova, Chris Cabansk, Sydney Lee, Yi Li), including current ad-hoc advisors/contributors Wei Zou, Ray Lin and Guiyuan Lei.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#overview">Overview</a></li>
      <li><a href="#install-and-load-the-package">Install and load the package</a></li>
      <li>
<a href="#input">Input</a><ul class="nav nav-pills nav-stacked">
<li><a href="#input-requirement">Input requirement</a></li>
      <li><a href="#example-data-set-baseline-only">Example data set: baseline only</a></li>
      </ul>
</li>
      <li>
<a href="#biomarker-workflow">Biomarker workflow</a><ul class="nav nav-pills nav-stacked">
<li><a href="#continuous-biomarker-in-a-two-arm-study-with-survival-outcome">Continuous biomarker in a two-arm study with survival outcome</a></li>
      <li><a href="#continuous-biomarker-in-a-single-arm-study-with-survival-outcome">Continuous biomarker in a single-arm study with survival outcome</a></li>
      <li><a href="#categorical-biomarker-with-survival-outcome">Categorical biomarker with survival outcome</a></li>
      <li><a href="#categorical-outcome-e-g-response">Categorical outcome (e.g. response)</a></li>
      <li><a href="#continuous-outcome">Continuous outcome</a></li>
      <li><a href="#longitudinal-analysis-e-g-pd-biomarker">Longitudinal analysis (e.g. PD biomarker)</a></li>
      </ul>
</li>
      <li><a href="#acknowledgement">Acknowledgement</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Ning Leng, Alexey Pronin, Doug Kelkhoff, Christina Rabe, Kwame Okrah.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
